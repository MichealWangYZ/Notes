\documentclass[hyperref, UTF8, a4paper]{ctexart}

\usepackage{geometry}
\usepackage{titling}
\usepackage{titlesec}
\usepackage{paralist}
\usepackage{footnote}
\usepackage{enumerate}
\usepackage{amsmath, amssymb, amsthm}
\usepackage{cite}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{physics}
\usepackage{tikz}
\usepackage[colorlinks, linkcolor=black, anchorcolor=black, citecolor=black]{hyperref}
\usepackage{prettyref}

\geometry{left=3.18cm,right=3.18cm,top=2.54cm,bottom=2.54cm}
\titlespacing{\paragraph}{0pt}{1pt}{10pt}[20pt]
\setlength{\droptitle}{-5em}
\preauthor{\vspace{-10pt}\begin{center}}
\postauthor{\par\end{center}}

\DeclareMathOperator{\timeorder}{T}
\DeclareMathOperator{\diag}{diag}
\newcommand*{\ii}{\mathrm{i}}
\newcommand*{\ee}{\mathrm{e}}
\newcommand*{\const}{\mathrm{const}}
\newcommand*{\comment}{\paragraph{注记}}
\newcommand*{\suchthat}{\quad \text{s.t.} \quad}
\newcommand*{\argmin}{\arg\min}
\newcommand*{\argmax}{\arg\max}
\newcommand*{\normalorder}[1]{: #1 :}

\newrefformat{sec}{第\ref{#1}节}
\newrefformat{note}{注\ref{#1}}
\renewcommand{\autoref}{\prettyref}

\newenvironment{bigcase}{\left\{\quad\begin{aligned}}{\end{aligned}\right.}

\title{固体理论}
\author{吴何友}

\begin{document}

\maketitle

记号约定：费米子的产生湮灭算符为$\hat{c}^\dagger$和$\hat{c}$，而如果是关于位置的产生湮灭算符，则为$\hat{\psi}^\dagger$和$\hat{\psi}$。
由于本文不涉及相对论性过程，设$\vb*{a}$为一个矢量，则使用$a$表示其模长。

本文取普朗克单位制，即认为$\hbar=c=1$，且$4\pi\epsilon_0=1$，$k_B=1$。

$\text{h.c.}$表示厄米共轭，$\text{c.c.}$表示复共轭。

\section{物质的组成}

\subsection{离子实和价电子}

普通的固体、液体、气体由一系列原子组成。通过实验和计算可以发现，原子的最外层电子在各种过程中容易发生重新排列，称为\textbf{价电子}；内层电子和原子核（合称为\textbf{离子实}）则通常保持为一个整体，也即，其内部状态发生变化的物理过程的描述需要使用QCD，其涉及的能标远高于价电子发生变化涉及的能标。

本文基本上只分析涉及价电子低能运动的物理过程，即只讨论非相对论极限下的电荷-电磁场耦合系统，带电粒子由薛定谔场完全描述，电磁场由库伦势完全描述。由此产生的系统具有$U(1)$对称性，因此无粒子数生灭，可以直接从单粒子量子力学出发构造其哈密顿量。而又由于体系很大，通常有确定的粒子数。
设有$N_e$个价电子，$N_i$个离子实（i表示离子）。
固体的（一次量子化）哈密顿量就是
\begin{equation}
    \hat{H} = \hat{H}_\text{e} + \hat{H}_\text{i} + \hat{H}_\text{ei},
    \label{eq:many-body-hamiltonian}
\end{equation}
其中$\hat{H}_\text{e}$表示仅涉及价电子的哈密顿量，$\hat{H}_\text{i}$表示仅涉及离子实的哈密顿量，最后一项则是两者的相互作用。

诸价电子组成的系统就好像由电子组成的气体，称为\textbf{相互作用电子气}。单体哈密顿量为电子的动能项加上单体势能项。在物质不受外界作用时当然不应该有单体势能项，于是
\[
    \hat{H}_\text{e1} = \frac{\hat{\vb*{p}}^2}{2m},
\]
在坐标表象下它就是
\[
    \hat{H}_\text{e1} = - \frac{\laplacian}{2m}.
\]
二体哈密顿量为电子两两作用而产生的库伦势能是
\[
    \hat{H}_\text{e2} = \frac{e^2}{\abs{\vb*{r}_1 - \vb*{r}_2}},
\]
从而价电子本身的能量以及它们之间发生库伦相互作用的能量就是
\begin{equation}
    \hat{H}_\text{e} = \sum_{i=1}^{N_\text{e}} \frac{\hat{p}_i^2}{2m_\text{e}} + \frac{1}{2} \sum_{i\neq j} \frac{e^2}{\abs{\vb*{r}_i - \vb*{r}_j}}.
\end{equation}

使用类似的方法，离子实的组成的系统（如果是晶体那就是晶格）的哈密顿量为
\begin{equation}
    \hat{H}_\text{i} = \sum_{\alpha=1}^{N_\text{i}} \frac{\hat{p}_\alpha^2}{2m_i} + \frac{1}{2} \sum_{\alpha\neq\beta} V(\vb*{R}_\alpha-\vb*{R}_\beta).
\end{equation}
由于离子实中的内层电子结构复杂，离子实之间的相互作用能写不出特别简单的表达式。请注意这个相互作用能是平移不变的，这是当然的，因为QED是平移不变的；但是实际的晶体在短距离上并不是平移不变的，因为在低能下有对称性自发破缺。

离子实和价电子的相互作用则是
\begin{equation}
    \hat{H}_\text{ei} = \sum_{\alpha, i} V_\text{ei}(\vb*{r}_i-\vb*{R}_\alpha). 
\end{equation}
分别使用$i$表示价电子，用$\alpha$表示离子实；由于价电子和离子实不全同，不需要加上$1/2$系数。
同样我们还是假定了相互作用本身的平移不变性。

以上给出的所有项都不涉及自旋。的确，没有磁场的环境中自旋和其它自由度完全没有耦合，因此可以略去。

\subsection{电子气的哈密顿量}

\subsubsection{玻恩–奥本海默近似}

在大部分过程中，由于原子核的质量比电子的质量大至少三个数量级，涉及价电子的过程通常比涉及离子实的过程发生得快很多，从而在价电子的时间尺度上，诸离子实的位置可以看成是给定的。
从而，在分析价电子时我们可以将$\hat{H}_i$项直接略去，而将$\hat{H}_\text{ei}(\vb*{r}_i-\vb*{R}_\alpha)$项对$\vb*{R}_\alpha$求和得到$V(\vb*{r}_i)$（既然系统中没有别的势了）。这个近似称为\textbf{玻恩–奥本海默近似}。这样一来相互作用电子气的一次量子化哈密顿量在坐标表象下就是
\begin{equation}
    \hat{H} = \sum_{i=1}^{N_\text{e}} \left( - \frac{\laplacian}{2m_\text{e}} + V(\vb*{r}_i)\right) + \frac{1}{2} \sum_{i\neq j} \frac{e^2}{\abs{\vb*{r}_i - \vb*{r}_j}},
    \label{eq:electron-gas-hamiltonian}
\end{equation}
从而二次量子化哈密顿量为
\begin{equation}
    \begin{aligned}
        \hat{H} = &\int \dd[3]{\vb*{r}} \hat{\psi}^\dagger(\vb*{r}) \left( - \frac{\laplacian}{2m} + V(\vb*{r}) \right) \hat{\psi}(\vb*{r}) \\
        &+ \frac{1}{2} \int \dd[3]{\vb*{r}_1} \int \dd[3]{\vb*{r}_2} \hat{\psi}^\dagger (\vb*{r}_1) \hat{\psi}^\dagger (\vb*{r}_2) \frac{e^2}{\abs{\vb*{r}_1 - \vb*{r}_2}} \hat{\psi} (\vb*{r}_2) \hat{\psi}(\vb*{r}_1). 
        \label{eq:electron-gas-hamiltonian-sq}
    \end{aligned}
\end{equation}
其中$\hat{\psi}^\dagger(\vb*{r})$是薛定谔场的场算符，它也是在位置为$\vb*{r}$的位置产生一个电子的产生算符。这个哈密顿量当然也可以通过QED的低能近似得到，但并没有必要这么做。请注意电子是费米子。
\eqref{eq:electron-gas-hamiltonian-sq}实际上不是对角的，因为它的单粒子项涉及一个梯度算符。

需要注意的是实际上仍然可能有电子和晶格的相互作用（即电子-声子相互作用），因此波恩-奥本海默近似中的电子质量可能出现和该相互作用相关的跑动，此时\eqref{eq:electron-gas-hamiltonian-sq}中的所谓“电子”已经是一种准粒子了。

\subsubsection{平均场近似和Hatree-Fock近似}

电子气的哈密顿量涉及复杂的相互作用项，这意味着我们难以求解它，甚至不能精确求解其基态——
例如，考虑一个粒子数给定的系统，从而可以从其二次量子化哈密顿量写出一次量子化哈密顿量（未必真的要写出，只需要知道粒子数对不上的态全部可以弃去即可），如果系统的哈密顿量是二次型的，则基态可以确定是一个乘积态，粒子从低到高占据能量尽可能低的能级；但如果有相互作用，那么根本就谈不上有特别明确的能级。

\textbf{平均场近似}是一种化解这个问题的方式，在其中，我们将粒子间的相互作用看成是一个外加的场（就是所谓的平均场），从而让系统的哈密顿量解耦为一系列单粒子哈密顿量的叠加。

% 关键点：假定其态为自由态，零温时就是Slater行列式，有限温时就是。能这么假定当然是因为没有粒子间相互作用，且没有实质性的粒子自身相互作用；这样做的动机是可以使用Wick1定理

例如，考虑相互作用电子气。对接近平衡态的体系，在我们考虑的空间尺度相对于单电子的特征尺度非常大时（例如，如果没有特别剧烈的电子-电子散射，从而诸电子可以认为离得很远），可以使用库伦相互作用能的期望值代替其本身。这个期望值为
\[
    \begin{aligned}
        \expval*{\hat{H}_\text{columbic}} &= \frac{1}{2} \int \dd[3]{\vb*{r}_1} \int \dd[3]{\vb*{r}_2} \frac{e^2}{\abs{\vb*{r}_1 - \vb*{r}_2}} \expval*{\hat{\psi}^\dagger (\vb*{r}_1) \hat{\psi}^\dagger(\vb*{r}_2) \hat{\psi} (\vb*{r}_2) \hat{\psi}(\vb*{r}_1)} \\
        &= \frac{1}{2} \int \dd[3]{\vb*{r}_1} \int \dd[3]{\vb*{r}_2} \frac{e^2}{\abs{\vb*{r}_1 - \vb*{r}_2}} \\
        & \times \left( \expval*{\hat{\psi}^\dagger(\vb*{r}_2) \hat{\psi} (\vb*{r}_2)} \expval*{\hat{\psi}^\dagger(\vb*{r}_1) \hat{\psi} (\vb*{r}_1) - \expval*{\hat{\psi}^\dagger(\vb*{r}_2) \hat{\psi} (\vb*{r}_1)}} \expval*{\hat{\psi}^\dagger(\vb*{r}_1) \hat{\psi} (\vb*{r}_2)} \right),
    \end{aligned}
\]
在大尺度上第二项趋于零，因为库仑力会衰减，且屏蔽效应等负反馈机制会加速这个衰减，而第一项是粒子数算符的期望，于是就得到
\begin{equation}
    \expval*{\hat{H}_\text{columbic}} = \frac{1}{2} \int \dd[3]{\vb*{r}_1} \int \dd[3]{\vb*{r}_2} \frac{e^2}{\abs{\vb*{r}_1 - \vb*{r}_2}} \expval*{\hat{n} (\vb*{r}_1)} \expval*{\hat{n} (\vb*{r}_2)}.
\end{equation}
% TODO

平均场近似倾向于高估系统的对称性破缺，因为在构造平均场时往往需要手动放入不对称性；有时平均场近似

假定体系\eqref{eq:electron-gas-hamiltonian-sq}的基态近似为
\begin{equation}
    \ket{\text{HF}} = \sum_\alpha \hat{c}_\alpha \ket{0},
    \label{eq:hatree-fock-ansatz}
\end{equation}
其中参与求和的$\hat{c}_\alpha$共有$n$个，$n$是事先给定的系统中的粒子数。
这个拟设等于是说，体系的基态和某个乘积态非常接近。
一般而言，不能够保证\eqref{eq:electron-gas-hamiltonian-sq}真的有形如\eqref{eq:hatree-fock-ansatz}的本征态，但是我们总是可以让\eqref{eq:hatree-fock-ansatz}的能量期望值取最小值，也即求解以下问题：
\begin{equation}
    \argmin_{\hat{\psi}} \mel{\text{HF}}{\hat{H}}{\text{HF}} \suchthat \text{$\hat{\psi}$ is a field operator}.
    \label{eq:minimize-energy}
\end{equation}
由于Hatree-Fock态是乘积态，可以使用Wick定理，并注意到依照定义有
\[
    \mel{0}{\hat{\psi}(\vb*{r})\hat{c}^\dagger_\alpha}{0} = \braket{\vb*{r}}{\phi_\alpha} = \phi_\alpha(\vb*{r}),
\]
$\phi_\alpha(\vb*{r})$为产生算符$\hat{c}^\dagger_\alpha$产生的粒子在坐标空间中的波函数，可以计算出
\[
    E_\text{HF} = \mel{\text{HF}}{\hat{H}}{\text{HF}} = 
\]
于是最优化问题\eqref{eq:minimize-energy}就变成一个约束优化问题：
\[
    \argmin_{\phi_\alpha(\vb*{r})} E_\text{HF} \suchthat \int \dd[3]{\vb*{r}} \abs{\phi_\alpha(\vb*{r})}^2 = 1, \quad \text{for all $\alpha$}.
\]

\subsubsection{近独立电子气}

很难一上手就处理带有复杂相互作用的电子气，因此我们首先处理\textbf{近独立电子气}，也就是电子之间近似没有相互作用的电子气。此时我们可以单独考虑每个电子的哈密顿量
\begin{equation}
    \hat{H} = \frac{\hat{\vb*{p}}^2}{2m_\text{e}} + V(\vb*{r}).
\end{equation}
整团电子气的哈密顿量是关于各个电子的哈密顿量之和。

近独立电子气的基态是什么？使用巨正则系综%
\footnote{当然，我们认为系统能够达到统计平衡，就意味着电子之间不可能真的完全没有相互作用，否则能量无法传递。}%
，对很大的近独立费米子系统，处在能量本征态$\ket{n}$上的粒子数的平均值为%
\footnote{以下使用$\epsilon$表示单个电子的能量而使用$E$表示系统总能量。}%
\begin{equation}
    \expval*{\hat{n}_n} = \frac{1}{\ee^{\beta (\epsilon_n-\mu)} + 1}.
\end{equation}
我们让能量尽可能低，那就是要让$T\to 0$，也就是让$\beta\to \infty$，此时就有
\begin{equation}
    \expval*{\hat{n}_n} = \begin{cases}
        1, \quad \epsilon_i \leq \mu, \\
        0, \quad \epsilon_i > \mu.
    \end{cases}
\end{equation}
这意味着，$T=0$时电子占据的所有状态就是
\begin{equation}
    \epsilon_i = \mu
\end{equation}
以内的所有能量本征态。在动量空间中这就是一个曲面，称为\textbf{费米面}。位于费米面上的所有能量本征态共同组成了一个能量正好是零温化学势的能级，称为\textbf{费米能级}，其能量称为\textbf{费米能量}。与费米能级对应的动量称为\textbf{费米动量}。
% TODO：哪个动量？晶格动量还是真的动量？

统计物理的论证只能把我们带到这里。具体化学势是多少需要根据
\begin{equation}
    \mu_i = \pdv{U}{N_i}
\end{equation}
计算。当然，化学势和粒子数、温度等因素都有关系。在$T=0$且电子数$N$给定时，常用的做法是显式地写出所有能量本征态，从小到大排列$N$个电子，从而计算出费米能量，然后我们就知道了$T=0$时的化学势。

不同粒子数对应的费米能量是不同的；并且，在分析有限温问题时，化学势不再是费米能量。然而，在温度不很高、粒子数很大时，不同粒子数对应的费米能量相差不大，并且化学势和费米能量（也就是$T=0$时的化学势）相差不大，因此有时会使用费米能量近似作为化学势。%
\footnote{关于本节的论述要着重指出一点：虽然我们采用了统计物理的论证来表明必然存在着一个费米面，从而有对应的费米能量，但统计物理的论证仅仅为我们提供了系统基态的性质，而无论系统是不是需要使用平衡态系综描述，它一定有一个基态。因此，费米面、费米能级等概念在任何情况下——无论是平衡态还是非平衡态、纯态还是混合态——全部是适用的。这些概念并不依赖统计物理的框架！}%

我们计算自由电子气的格林函数，这就等价于计算其谱函数。
\begin{equation}
    A(\vb*{k}, \omega) = \delta(\omega - \epsilon_{\vb*{k}}),
\end{equation}
\begin{equation}
    G^\text{ret}(\vb*{k}, \omega) = \frac{1}{\omega - \epsilon_{\vb*{k}} + \ii 0^+}.
\end{equation}

\subsubsection{自由电子气}

现在我们讨论最为简单的电子气，也就是$V(\vb*{r})$在物体内部为常数（可以看成零）的情况。此时可以将价电子一个个分开处理，既然它们之间没有相互作用。

我们在坐标表象下处理问题。计算单个电子的波函数：
\[
    - \frac{\laplacian}{2m_\text{e}} \psi(\vb*{r}) = \epsilon \psi(\vb*{r}),
\]
这种方程的解当然是平面波解的线性组合。一个这样的平面波解形如
\[
    \psi(\vb*{r}) \propto \ee^{\ii \vb*{k} \cdot \vb*{r}}.
\]
只能保证这个式子在物体内部成立，因为物体边界处$V(\vb*{r})$不可能是常数。
然后我们归一化这些平面波。电子可以自发地溢出物体，但是这样的概率并不大，所以我们可以简单地认为电子只会出现在物体内部（也即，物体被放置在一个无限深势陷当中）。设物体体积为$V$，就有
\[
    \int \dd[3]{\vb*{r}} \abs{\psi(\vb*{r})}^2 = 1,
\]
于是
\[
    \psi (\vb*{r}) = \frac{1}{\sqrt{V}} \ee^{\ii \vb*{k} \cdot \vb*{r}}, \quad \epsilon = \frac{k^2}{2m_\text{e}}.
\]
很容易看出这些波函数实际上是动量算符的本征态，$\vb*{k}$实际上就是动量。另一方面，这些波函数定义在坐标空间中，坐标空间中的一切都和自旋算符对易，因此这些波函数也是自旋本征态。于是动量和自旋的一组共同正交本征函数为
\begin{equation}
    \psi_{\vb*{k},\sigma} (\vb*{r}) = \frac{1}{\sqrt{V}} \ee^{\ii \vb*{k} \cdot \vb*{r}}, \quad \epsilon_{\vb*{k},\sigma} = \frac{k^2}{2m_\text{e}}.
\end{equation}
% 真的是这个名字吗？这些波函数称为\textbf{布洛赫波函数}。
$\vb*{k}$能够取什么值取决于边界条件。由于物体通常比较大，具体取什么样的边界条件对物体内部的过程毫无影响。

\subsection{离子实}

现在我们转而讨论晶格本身的运动。为了避免混淆使用大写字母表示关于离子实的物理量。使用

\subsection{费米海和空穴}

% TODO:
% TODO：粒子空穴对称性？？

\subsection{费米液体理论}

朗道注意到，出于某些奇怪的原因，很多相互作用电子气的行为和自由电子气实际上非常相似，参数可能不同但是定性行为都是一样的。

\section{理想晶体}

所谓晶体指的是一种在三个独立的空间方向上具有离散的平移不变性且并没有连续平移不变性的物体。\eqref{eq:many-body-hamiltonian}显然具有连续的平移不变性，因此晶体的形成必然经历了对称性自发破缺，且在较高的能量下原本的晶体一定会相变成某种更加均匀的东西。

本节讨论\textbf{理想晶体}，即非常大，以至于其表面的情况几乎不会影响内部电子运动的晶体。

\subsection{晶格的几何形状}

我们采取玻恩–奥本海默近似，将离子实看成一个背景，而忽略其中的自由度（既然这些自由度在价电子的物理过程的时间尺度上基本上不参加相互作用）。这样一来离散的平移不变性只应该来自$V(\vb*{r})$。
我们于是看到了形成晶体的对称性自发破缺的来源：低能下离子实自发地排成了比较规则的序列，从而虽然晶体服从的物理规律实际上确实是连续平移不变的，近似定律\eqref{eq:electron-gas-hamiltonian}却由于离子实排列成了空间重复的序列而只有离散平移不变性而没有连续平移不变性。
我们称这种离子实周期性排列形成的结构为\textbf{晶格}。

既然晶格具有空间周期性，只要知道了一个离子实的位置以及空间周期性的方向（晶体的空间指向）就可以知道所有离子实的位置。任意两个离子实之间的位置矢量形如
\begin{equation}
    \vb*{R}_n = n_1 \vb*{a}_1 + n_2 \vb*{a}_2 + n_3 \vb*{a}_3, \quad n = (n_1, n_2, n_3) \in \mathbb{N}^3.
\end{equation}
这些位置矢量构造了一架三维网格，这个网格称为\textbf{布拉维格子}，这些矢量称为\textbf{布拉维格矢}，$\{\vb*{a}_i\}$称为\textbf{晶格常数}，$n$称为\textbf{格点坐标}。

布拉维格子的\textbf{原胞}（也就是空间周期性结构的最小单位）有许多划分方法。可以以$\vb*{a}_1, \vb*{a}_2, \vb*{a}_3$张成的长方体为一个原胞，称为\textbf{初基原胞}。
另一种原胞是\textbf{维格纳-赛兹原胞}，它是空间中与某个特定格点的距离小于与任何其它格点的距离的点的轨迹，或者等价地说，它是某个特定格点与相邻格点的连线的垂直平分面包围出的立体。
维格纳-赛兹原胞的特别之处在于，任意一个空间矢量都可以写成维格纳-赛兹原胞中的一个矢量加上一个布拉维格矢，这可以使用非常直观的方式证明。

\subsubsection{晶格分类}

% TODO：群论

\subsubsection{倒格子}

有关晶体的所有可观察物理量均具有和布拉维格矢一样的对称性，也即，它们在三个方向上以$\vb*{a}_1,\vb*{a}_2,\vb*{a}_3$为周期。
回顾傅里叶级数的公式，我们有
\[
    f(x) = \frac{1}{T} \sum_{m=-\infty}^\infty \ee^{\ii \frac{2\pi m x}{T}} \left(\int \dd{t} f(t) \ee^{-\ii \frac{2\pi m t}{T}}\right) ,
\]
其三维形式就是
\[
    f(\vb*{r}) = \frac{1}{V} \sum_{m=-\infty}^\infty \ee^{\ii \vb*{G}_m \cdot \vb*{r}} \int_V \dd[3]{\vb*{r}'} f(\vb*{r}') \ee^{- \ii \vb*{G}_m \cdot \vb*{r}}, \quad \vb*{G}_m \cdot \vb*{a}_i = 2\pi N_i, \quad N_i \in \mathbb{N}.
\]
$\vb*{G}_m$满足的条件等价于，对任意的布拉维格矢都有
\begin{equation}
    \vb*{G}_m \cdot \vb*{R}_n = 2\pi N, \quad N \in \mathbb{N},
\end{equation}
这又等价于，
\begin{equation}
    \vb*{G}_m = G_1 \vb*{b}_1 + G_2 \vb*{b}_2 + G_3 \vb*{b}_3, \quad \vb*{a}_i \cdot \vb*{b}_j = 2 \pi \delta_{ij}.
\end{equation}
因此诸$\vb*{G}_m$也构成一个布拉维格子，我们称它为\textbf{倒格子}，与$\vb*{R}_n$构成的空间网格（称为\textbf{正格子}）相区分，同样，称$\vb*{r}$所在的三维空间为\textbf{实空间}，$\vb*{G}$所在的空间为\textbf{倒空间}。倒格子的基矢量和正格子的基矢量互为共轭基矢量。
两种格子的基矢量可以通过下式
\begin{equation}
    \frac{1}{2\pi} \vb*{b}_1 = \frac{\vb*{a}_2 \times \vb*{a}_3}{\vb*{a}_1 \cdot (\vb*{b}_2 \times \vb*{b}_3)}
\end{equation}
及其轮换相互换算。
在写出倒格子的显式表达式之后，晶体中的周期性量的傅里叶变换就是
\begin{equation}
    F(\vb*{r}) = \sum_{\vb*{g}} \tilde{F}(\vb*{g}) \ee^{\ii \vb*{g} \cdot \vb*{r}},
\end{equation}
其中$\vb*{g}$是布拉维格矢，且
\begin{equation}
    \tilde{F}(\vb*{g}) = \frac{1}{V} \int_V \dd[3]{\vb*{r}} F(\vb*{r}) \ee^{-\ii \vb*{g} \cdot \vb*{r}}.
\end{equation}

倒格子的维格纳-赛兹原胞称为\textbf{第一布里渊区}，相应的，某格点和它所有次近邻格点的垂直平分面包围成的区域称为\textbf{第二布里渊区}，等等。
显然，倒格子所在的整个动量空间可以被划分为不相交的一系列第一布里渊区。
引入第一布里渊区这个概念的原因在于它实际上是定义在正格子上的函数的傅里叶变换的动量取值范围。
使用$i=(i_1, i_2, i_3)$表示格点坐标，则
\begin{equation}
    \frac{1}{N} \sum_{\vb*{a}_i} \ee^{\ii (\vb*{k} - \vb*{k}') \cdot \vb*{a}_i} = \sum_{\vb*{g}} \delta(\vb*{k} - \vb*{k}' + \vb*{g}),
\end{equation}
其中$\vb*{a}_i$指的是$i$对应的位矢，$N$是晶格中总离子数，$\vb*{g}$扫过整个倒格子。$\delta(\vb*{k} - \vb*{k}')$实际上应该是离散$\delta$函数，但是为了和连续动量的情况保持一致我们还是使用这个记号。
可以看到方程右边是周期性的，如果限制$\vb*{k}$在第一布里渊区中，那么就有非常简单的形式：
\begin{equation}
    \frac{1}{N} \sum_{\vb*{a}_i} \ee^{\ii (\vb*{k} - \vb*{k}') \cdot \vb*{a}_i} = \delta(\vb*{k} - \vb*{k}'),
\end{equation}
从而得到与之对偶的
\[
    \frac{1}{N} \sum_{\vb*{k}} \ee^{\ii (\vb*{a}_i - \vb*{a}_j)} = \delta_{ij}.
\]

并非所有晶体中的物理量都是周期性的，它们的傅里叶变换中的动量不局限在倒格子上。

\subsubsection{有限大小的晶体}

晶格对电子的吸引比较明显，因此电子自发溢出晶格的概率并不大，从而可以将晶格表面看成一个势阱。
晶格表面的形状以及势阱的高度无疑会影响电子气的行为，但由于晶体非常大，这种影响对稍微远离表面的电子都是非常微弱的。（接近表面的电子可能参与表面态，此时关于晶体表面的信息就非常重要了）
因此我们认为晶体是长宽高各为$L$的大正方体，$L$相对电子、原子的尺度都是非常大的；同时我们简单地施加一个周期性边界条件来表示势阱的存在，即认为
\begin{equation}
    \psi(\vb*{r}) = \psi(\vb*{r} + L \vb*{e}_i), \quad i = 1, 2, 3.
    \label{eq:periodic-boundary}
\end{equation}
同时我们暂时忽略在晶体外找到电子的概率，因为它相对于在晶体内部找到电子的概率是非常小的。

由于晶体是有限大小的，$\vb*{k}$的取值是离散化的，因为波函数必须满足\eqref{eq:periodic-boundary}，为了尽可能让$u$容纳较多信息，我们用$\vb*{k}$来满足这个要求，即
\[
    \ee^{\ii \vb*{k} \cdot \vb*{r}} = \ee^{\ii \vb*{k} \cdot (\vb*{r} + L \vb*{e}_i)}, \quad i = 1, 2, 3,
\]
这样$\vb*{k}$的取值范围就是一个晶格常数为$2\pi / L$的三维点阵。%
\footnote{这个点阵不是倒格子：倒格子的晶格常数和实际的物理结构——也就是晶格的结构——有关，而此处的点阵的晶格常数完全是我们强加的，且总是趋于零，使得格点动量看起来几乎是连续的，因此可以被划分成连续的布里渊区，等等。
}%
这个三维点阵正是局限在晶体内部的任何函数做空间傅里叶变换得到的波矢的取值范围，且有如下归一化条件：
\begin{equation}
    \frac{1}{V} \int \dd[3]{\vb*{r}} \ee^{\ii (\vb*{k} - \vb*{k}') \cdot \vb*{r}} = \delta(\vb*{k} - \vb*{k}'),
\end{equation}
其中$\delta(\vb*{k} - \vb*{k}')$实际上应该是离散$\delta$函数，但是为了和连续动量的情况保持一致我们还是使用这个记号。

现在我们有三种动量空间：
\begin{itemize}
    \item 晶格常数为$2\pi / L$的三维点阵是被限制在边长为$L$的实空间方盒中的函数的傅里叶变换的动量取值范围；
    \item 倒格子是具有和晶格一样的周期性的函数的傅里叶变换的动量取值范围；
    \item 第一布里渊区是定义在正格子上的函数的傅里叶变换的动量取值范围。
\end{itemize}

\subsection{布洛赫电子和能带理论}

\subsubsection{布洛赫电子}

现在尝试求解理想晶体中的电子气。由于晶格具有离散平移不变性，\eqref{eq:electron-gas-hamiltonian}也具有（而且只有）离散平移不变性，从而波函数也具有这样的不变性。我们有
\[
    \psi(\vb*{r}+\vb*{R}_n) = \ee^{\ii \alpha} \psi(\vb*{r}).
\]
请注意波函数的对称性可以略微低于哈密顿量，只要由它计算出的物理量的对称性和哈密顿量一致就可以，因此我们加上了复数因子。由于平移运算构成群，且$n$是群参数，有
\[
    R_{n_1+n_2} = R(n_1) R(n_2),
\]
波函数的形式只能是
\begin{equation}
    \psi(\vb*{r}+\vb*{R}_n) = \ee^{\ii \vb*{k} \cdot \vb*{R}_n} \psi(\vb*{r})
    \label{eq:periodic-wavefunction}
\end{equation}
及其线性组合。因此\eqref{eq:periodic-wavefunction}构成晶体中电子气中单个电子的态空间的一组基，且$\vb*{k}$是一个好量子数，称为\textbf{格点动量}或者\textbf{准动量}。它的性质类似动量，但并不是动量。
$\vb*{k}$是坐标系无关的真正的矢量。\eqref{eq:periodic-wavefunction}又说明，我们可以设
\begin{equation}
    \psi_{\vb*{k}}(\vb*{r}) = \ee^{\ii \vb*{k} \cdot \vb*{r}} u_{\vb*{k}}(\vb*{r}), \quad u_{\vb*{k}}(\vb*{r}+\vb*{a}_i) = u_{\vb*{k}}(\vb*{r}), \quad i = 1, 2, 3.
    \label{eq:bloch-wavefunction}
\end{equation}
因此，晶体中的波函数是一个受到一个周期为$\vb*{a}_1,\vb*{a}_2, \vb*{a}_3$的振幅调制的平面波。
\eqref{eq:bloch-wavefunction}称为\textbf{布洛赫波函数}，处于这种状态的电子称为\textbf{布洛赫电子}。

由于指数函数的周期性，设$\vb*{G}$是一个任意的倒格子格矢，那么就有
\[
    \psi_{\vb*{k}}(\vb*{r}) = \psi_{\vb*{k}+\vb*{G}}(\vb*{r}).
\]
因此，没有必要让$\vb*{k}$取遍整个空间。由维格纳-赛兹原胞的性质，对任何一个$\vb*{k}$，都存在一个第一布里渊区内部的$\vb*{k}'$，使得
\[
    \psi_{\vb*{k}}(\vb*{r}) = \psi_{\vb*{k}'}(\vb*{r}).
\]
另一方面，第一布里渊区内部的矢量彼此的差值不可能达到一个倒格子格矢的大小，因此第一布里渊区内部的$\vb*{k}$不会导致重复的波函数。于是不失一般性地我们可以要求$\vb*{k}$在第一布里渊区内部。

\subsubsection{定态解，即布洛赫波函数}

波函数表达式\eqref{eq:bloch-wavefunction}没有时间演化，所以现在我们讨论布洛赫电子的动力学。即使使用了波恩-奥本海姆近似，\eqref{eq:electron-gas-hamiltonian}仍然要求把系统内所有的电子均考虑进去。
为了简便，我们采用平均场近似，将电子之间的相互作用使用一个平均场代替，从而只需讨论单电子的薛定谔方程。这通常是合理的，因为电子由于泡利不相容原理，彼此通常离得比较远。于是布洛赫电子的动力学等价于求解形如\eqref{eq:bloch-wavefunction}的波函数在某个势场下的束缚态解。将\eqref{eq:bloch-wavefunction}代入
\[
    -\frac{\laplacian}{2m_\text{e}} \psi(\vb*{r}) + V(\vb*{r}) \psi(\vb*{r}) = \epsilon \psi(\vb*{r}),
\]
得到
\begin{equation}
    \left( - \frac{(\grad+\vb*{k})^2}{2m_\text{e}} + V(\vb*{r}) \right) u_{\vb*{k}}(\vb*{r}) = \epsilon u_{\vb*{k}}(\vb*{r}).
    \label{eq:block-energy-problem}
\end{equation}
在$\vb*{k}$已知的情况下求解该本征值问题，可以得到一组$u$以及对应的$E$。由于先前要求$u(\vb*{r})$是周期函数，该本征值问题必定给出离散谱，也即，我们会获得一组$(\psi_{n \vb*{k}}, \epsilon_{n \vb*{k}})$，使得
\begin{equation}
    \left( - \frac{(\grad+\vb*{k})^2}{2m_\text{e}} + V(\vb*{r}) \right) u_{n \vb*{k}}(\vb*{r}) = \epsilon_{n \vb*{k}} u_{n \vb*{k}}(\vb*{r}).
\end{equation}
显然，$n$是另一个（离散的）好量子数。一旦$\vb*{k}$和$n$给定，布洛赫波函数及其时间演化就完全求解出来了，从而$\vb*{k}$和$n$是坐标空间中的布洛赫波函数的全部好量子数。我们称取不同$n$值的电子处于不同的\textbf{能带}上，$n$为能带标记。%
\footnote{注意到，能带的导出实际上并未用到太多晶体的性质（空间周期性等），因此非晶体很多时候也有能带。}%

由于晶体近似在一个无限深势阱中，波函数在晶体边界处快速衰减为零。这就意味着$\vb*{k}$实际上是离散的。然而，由于晶体的尺度通常远大于原子的尺度，$\vb*{k}$近似可认为是连续的。于是可以写出函数
\[
    \epsilon = \epsilon_n(\vb*{k}),
\]
由于$\vb*{k}$加上任何一个倒格矢之后给出同样的布洛赫波函数，$E$相对于$\vb*{k}$应该具有周期性，那么它必定是有界的。
% TODO：这一段存疑？
这就是“能带”这个名称的来源：穷举第一布里渊区内部的所有$\vb*{k}$，得到的所有能量组成一条有限宽的条带。

最后我们指定波函数的归一化方式。可以在积分号前面加上一个系数，即
\begin{equation}
    \frac{1}{V} \int \dd[3]{\vb*{r}} \psi_{n\vb*{k}}^*(\vb*{r}) \psi_{m\vb*{k}'}(\vb*{r}) = \delta_{mn} \delta(\vb*{k}-\vb*{k}'),
    \label{eq:bloch-is-basis}
\end{equation}
从而让简单的平面波$\exp(\ii \vb*{k} \cdot \vb*{r})$不需要乘上归一化因子就能够成为归一化本征态。
设$V_\text{u.c.}$是单个晶胞的大小，则
\[
    V = N V_\text{u.c.},
\]
从而可以得到% TODO：详细推导
\begin{equation}
    \frac{1}{V_\text{u.c.}} \int_\text{u.c.} \dd[3]{\vb*{r}} u_{m\vb*{k}}^*(\vb*{r}) u_{n\vb*{k}}(\vb*{r}) = \delta_{mn}.
\end{equation}
只需要求解出一组满足以上条件的$\{u_{n\vb*{k}}\}$，就得到了一组正交归一化波函数$\{\psi_{n\vb*{k}}\}$。

\eqref{eq:bloch-is-basis}意味着布洛赫波函数是正交归一化波函数且对应的积分测度为
\[
    \frac{1}{\sqrt{V}} \int \dd[3]{\vb*{r}},
\]
记$\hat{c}_{n\vb*{k}}^\dagger$为位于能带$n$、格点动量为$\vb*{k}$的布洛赫电子的产生算符，那么%
\footnote{其中的$1/\sqrt{V}$的因子是因为二次量子化场算符通常使用全空间的积分为内积的定义，在此定义下，归一化的波函数是$\psi_{n\vb*{k}} / \sqrt{V}$而不是$\psi_{n\vb*{k}}$。}%
\begin{equation}
    \hat{c}_{n \vb*{k}}^\dagger = \frac{1}{\sqrt{V}} \int \dd[3]{\vb*{r}} \psi_{n \vb*{k}}(\vb*{r}) \hat{\psi}^\dagger(\vb*{r}),
\end{equation}
就有二次量子化哈密顿量
\begin{equation}
    \hat{H} = \sum_{n, \vb*{k}} \epsilon_{n\vb*{k}} \hat{c}^\dagger_{n\vb*{k}} \hat{c}_{n\vb*{k}}.
\end{equation}
$\vb*{k}$的取值局限在第一布里渊区内部，作为对比，不考虑周期势的边长为$L$的正方体势阱中的电子的$\vb*{k}$可以取遍所有位于那个边长为$2\pi / L$的格点。
但实际上两者的自由度是一样的，因为我们还有$n$标记各个能带，也即，我们相当于把所有能带中的动量都移动到了第一布里渊区内部。
% TODO：自由布洛赫电子的哈密顿量是不是也和自由电子气差不多？？

\subsubsection{Wannier波函数}

布洛赫波函数是格点动量空间中的波函数，我们当然可以在坐标空间中讨论问题，对应的波函数基底称为\textbf{Wannier波函数}。两者之间差一个（离散傅里叶）变换。
定义在格点上的函数以第一布里渊区为动量空间。我们使用$i, j, \ldots$表示格点坐标，$m, n, \ldots$表示能带编号，$\vb*{r}_i$表示$i$处的格点的位矢，则
\[
    w_{ni}(\vb*{r}) \propto \sum_{\vb*{k}} \psi_{n\vb*{k}}(\vb*{r}) \ee^{- \ii \vb*{k} \cdot \vb*{r}_i},
\]
上式前面的归一化系数尚未选定。在归一化布洛赫波函数时我们使用了积分测度
\[
    \frac{1}{V} \int \dd[3]{\vb*{r}},
\]
从而导致归一化条件中出现了关于整块晶体的参数$V$。对布洛赫波函数这是合理的，因为它的好量子数是动量，因此是非常不定域的波函数，但Wannier波函数使用格点坐标标记，因此是非常定域的波包，因此我们希望Wannier波函数的归一化因子应该是一个常数而不包含任何关于系统大小的信息。
容易计算出
\[
    \frac{1}{V} \int \dd[3]{\vb*{r}} \frac{1}{N} \left( \sum_{\vb*{k}} \psi^*_{n\vb*{k}}(\vb*{r}) \ee^{\ii \vb*{k} \cdot \vb*{r}_i} \right) \left( \sum_{\vb*{k}} \psi_{m\vb*{k}}(\vb*{r}) \ee^{- \ii \vb*{k} \cdot \vb*{r}_j} \right) = \delta_{mn} \delta_{ij},
\]
取
\begin{equation}
    w_{ni}(\vb*{r}) = \frac{1}{N} \sum_{\vb*{k}} \psi_{n\vb*{k}}(\vb*{r}) \ee^{-\ii \vb*{k} \cdot \vb*{r}_i}, \quad \psi_{n\vb*{k}} = \sum_{\vb*{r}_i} \ee^{\ii \vb*{k} \cdot \vb*{r}_i} w_{ni}(\vb*{r}),
\end{equation}
这样归一化条件就是
\begin{equation}
    \frac{1}{V_\text{u.c.}} \int \dd[3]{\vb*{r}} \abs{w_{ni}(\vb*{r})}^2 = 1.
\end{equation}
归一化常数是一个局域的晶胞体积，符合我们的要求。

现在来分析Wannier波函数在实空间中的具体形状。考虑到$u_{n\vb*{k}}$的周期性，我们有
\[
    u_{n\vb*{k}} (\vb*{r}) = u_{n\vb*{k}} (\vb*{r} - \vb*{r}_i),
\]
于是
\begin{equation}
    w_{ni}(\vb*{r}) = \frac{1}{N} \sum_{\vb*{k}} u_{n\vb*{k}} (\vb*{r} - \vb*{r}_i) \ee^{\ii \vb*{k} (\vb*{r} - \vb*{r}_i)},
\end{equation}
这表明Wannier波函数实际上是$\vb*{r} - \vb*{r}_i$的函数，可以写成
\[
    w_{ni}(\vb*{r}) = w_{n}(\vb*{r} - \vb*{r}_i),
\]
这当然是正确的，因为晶格中绝对位置$\vb*{r}$并无意义。
在$\vb*{r}$远离$\vb*{r}_i$时，指数因子快速振荡，导致整个求和基本上为零，因此Wannier函数只在$\vb*{r}_i$附加有较明显的值，因此它定域在格点$\vb*{r}_i$附近。

同样，Wannier波函数既然是一组正交归一化基底，就可以定义对应的二次量子化算符，即
\begin{equation}
    \hat{c}^\dagger_{ni} = \frac{1}{\sqrt{V_\textbf{u.c.}}} \int \dd[3]{\vb*{r}} w_{ni}^*(\vb*{r}) \hat{\psi}^\dagger(\vb*{r}).
\end{equation}

总之，晶格中的电子的波函数可以以高度定域在格点附近的一组波函数为基底，并且以对应的格点为一个量子数。

\subsubsection{紧束缚模型}

对一对$\{mi, nj\}$的组合只求和一次，就得到
\begin{equation}
    \hat{H} = - \sum_{\{mi, nj\}} t_{mi, nj} \hat{c}_{mi}^\dagger \hat{c}_{nj} + \text{h.c.}.
\end{equation}

\begin{equation}
    \hat{H} = \sum_{n,i,m,i}
\end{equation}

\subsection{晶格和声子}

首先考虑做小幅运动的离子实，即取简谐近似，这样晶格实际上仍然可以看成一个自由系统，哈密顿量为
\begin{equation}
    \hat{H} = \sum_i \frac{\hat{P}_n^2}{2M} + 
\end{equation}
其中$i$指的是晶格坐标，也就是三元组$(n_1, n_2, n_3)$。

% TODO：声学声子和光学声子

可以看到，声子和电子的量子化是很不相同的。对电子，我们首先写出一个多体一次量子化哈密顿量，然后做二次量子化；而对声子，我们实际上把使用格点坐标标记的离子实位移和动量当成了场算符（离散的场），然后直接对这两个场算符做正则量子化。
换而言之，没有声子的一次量子化：定义声子时我们的理论就是二次量子化的。

\section{线性响应}

本节讨论对晶体引入小的外界扰动会导致的结果。

\subsection{外加电荷}

\subsubsection{托马斯-费米静态屏蔽势}

想象我们在近独立电子气当中放入一个电荷。显然，异号电荷会移动到前者附近而产生一个屏蔽效应。
在电子气规模很大时（我们所研究的固体总是在热力学极限之下，因此这是成立的），屏蔽效应很强，这让外加电荷对电子气的扰动实际上局限在外加电荷的一个小邻域内。

求解这个静态屏蔽问题实际上就是求解以下自洽问题：
\begin{enumerate}
    \item 外加电荷导致外加电势能
    \begin{equation}
        \phi_\text{ext} = \frac{Q}{r},
    \end{equation}
    \item 外加电势与屏蔽电荷形成的电势$\var{\phi}$叠加，导致总的电势变化为
    \begin{equation}
        \phi_\text{eff} = \phi_\text{ext} + \var{\phi},
    \end{equation}
    \item 总电势变化$\phi_\text{eff}$导致了电荷密度变化$\var{n}$，而电荷密度变化和$\var{\phi}$之间有一个关系，
\end{enumerate}
从而可以确定所有物理量。

由于没有电子间相互作用且体系充分大，我们使用费米-狄拉克分布
\begin{equation}
    n = \sum_{\vb*{k}, \sigma} \frac{1}{1 + \ee^{\beta (\epsilon_{\vb*{k}} - \mu)}},
\end{equation}
$V_\text{eff}$改变粒子排布的方式是，通过让单电子的能量发生一个小的变化，且这个小的变化在不同位置通常是不一样的。
我们在较大的尺度上分析问题（采取半经典模型），从而每个$\vb*{r}$位置附近的诸电子都可以认为是组成了一个正则系综，记这个系综的粒子数算符为$\hat{n}(\vb*{r})$。
由于体系足够大，屏蔽作用让外加电荷的作用几乎是局域的，则$\var{n}(\vb*{r})$可以写成$V_\text{eff}(\vb*{r})$的函数而不涉及长程相互作用。
而由于外加电荷很小，可以采取线性近似，于是（第二个等号是因为费米-狄拉克分布的形式）
\[
    \var{n} = \dv{n}{V_\text{eff}} V_\text{eff} = \sum_{\vb*{k}} \pdv{n}{\epsilon_{\vb*{k}}} V_\text{eff} = - \pdv{n}{\mu} V_\text{eff},
\]
定义
\begin{equation}
    N(\mu' - \mu) = \pdv{n}{\mu'},
\end{equation}
其中我们将$n$的表达式中的$\mu$换成了变量$\mu'$，而使用$\mu$表示实际系统的化学势。使用该记号，则
\begin{equation}
    \var{n}(\vb*{r}) = - N(0) V_\text{eff}(\vb*{r}).
\end{equation}
这就是从$V_\text{eff}$计算$\var{n}$的方法。通过$\var{n}$计算$\var{\phi}$的方程为泊松方程
\[
    - \laplacian \phi_\text{eff} = 4 \pi \left( Q (\vb*{r}) - e \var{n}(\vb*{r}) \right),
\]
其中我们不失一般性地将外加电荷放在原点上。使用傅里叶变换并且使用$\var{n}$和$V_\text{eff}$之间的线性关系，可以得到
\[
    k^2 V_\text{eff}(\vb*{k}) = - 4\pi e Q - 4 \pi e^2 N(0) V_\text{eff}(\vb*{k}),
\]
做傅里叶逆变换得到
\begin{equation}
    V_\text{eff}(\vb*{r}) = - \frac{eQ}{r} \ee^{- \kappa_\text{TF} r},
    \label{eq:thomas-fermi-potential}
\end{equation}
其中
\begin{equation}
    \kappa_\text{TF} = 4 \pi e^2 N(0).
\end{equation}
这个结果就是\textbf{托马斯-费米屏蔽}。

\subsubsection{动态屏蔽响应}

托马斯-费米屏蔽是静态的。现在考虑一般的近独立电子气的线性响应。外加电势导致如下的相互作用哈密顿量：
\begin{equation}
    \hat{H}_\text{ext} = \int \dd[3]{\vb*{r}} \hat{n}(\vb*{r}, t) V_\text{ext} (\vb*{r}, t),
\end{equation}
则它对电子数密度的影响可以使用（各向同性不含时体系的）推迟格林函数
\begin{equation}
    G^\text{ret}_{nn}(\vb*{r}-\vb*{r}', t-t') = - \ii \Theta(t-t') \expval*{\comm{\var{\hat{n}}(\vb*{r}, t)}{\var{\hat{n}}(\vb*{r}', t')}}
\end{equation}
建模，而响应就是% TODO：为什么假定了空间平移不变
\begin{equation}
    \expval*{\var{\hat{n}}(\vb*{r}, t)} = \int \dd{t'} G^\text{ret}_{nn}(\vb*{r}-\vb*{r}', t-t') V_\text{ext}(\vb*{r}', t),
\end{equation}
在频域中就是
\begin{equation}
    \expval*{\var{\hat{n}}(\vb*{k}, \omega)} = G^\text{ret}_{nn}(\vb*{k}, \omega) V_\text{ext}(\vb*{k}, \omega).
    \label{eq:green-function-electro-shielding}
\end{equation}

外加势场是怎么影响电荷分布的？同上一节的经典处理一样，自洽方程可以通过
\begin{enumerate}
    \item 外加电荷引入外加电势能，
    \item 外加电势能导致屏蔽电荷，屏蔽电荷和外加电势能一起导致总的电势能变化，
    \item 而最后总的电势能变化可以反推出屏蔽电荷
\end{enumerate}
这样的方法给出。
第二步可以通过\eqref{eq:green-function-electro-shielding}得到。
粒子数的平均值近似为一个经典的数密度，从而$\var{V}$可以使用泊松方程写成
\[
    - \laplacian \var{V}(\vb*{r}, t) = - 4\pi e^2 \expval*{\var{\hat{n}}(\vb*{r}, t)},
\]
也即
\begin{equation}
    k^2 \var{V}(\vb*{k}, \omega) = 4\pi e^2 \expval*{\var{\hat{n}}(\vb*{k}, \omega)}.
\end{equation}
于是第三步也完成了。

由于我们讨论的是一般的近独立电子气，格林函数是不容易计算的。
作为一个比较简单的近似，我们做\textbf{RPA近似}，即认为$\var{\hat{n}}$和$V_\text{eff}$之间的响应函数近似是自由电子的密度-密度格林函数，即
\begin{equation}
    \expval*{\var{\hat{n}}(\vb*{k}, \omega)} = G^\text{0, ret}_{nn} (\vb*{k}, \omega) V_\text{eff} (\vb*{k}, \omega).
\end{equation}
% 无能隙的激发能够把特别奇异的相互作用屏蔽掉（RPA近似），从而让微扰展开收敛得非常快。如果担心RPA不对，只需要把对的部分加上做微扰就可以了
这样就得到自洽方程
\begin{equation}
    V_\text{ext}(\vb*{k}, \omega) + \frac{4\pi e^2}{k^2} \expval*{\var{\hat{n}}(\vb*{k}, \omega)} = (G^\text{0, ret}_{nn} (\vb*{k}, \omega))^{-1} \expval*{\var{\hat{n}}(\vb*{k}, \omega)}.
\end{equation}

使用松原格林函数方法计算自由电子的密度-密度格林函数。由于是自由理论，

\[
    G_{nn}^\text{0, ret} = \sum_\sigma \sum_k 
\]

\subsubsection{等离子体和等离激元}

\subsection{单杂质与局域磁矩}

考虑一个无相互作用的体系，我们在其中引入一个杂质，并且假定该杂质能够将电子紧密地约束在其周围。
这样一来我们就有了两套能级：一套是原本的费米液体，还有一套是一个单独的能级，处于这个能级的电子被束缚在杂质周围。
需要使用晶格动量和自旋标记前者（仅考虑能量最低的能带），称为\textbf{巡游电子}，因为它的波函数是布洛赫波函数，并不定域；后者是定域的，只需要使用自旋即可标记后者，称为\textbf{d电子}（因为很多时候这个轨道是杂质的d轨道）。
前者和后者可以自然地转化，即两者之间有\textbf{杂化}，于是描述它们的模型就是以下\textbf{单杂质的Anderson模型}：
\begin{equation}
    \hat{H} = \sum_{\vb*{k}, \sigma} \epsilon_{\vb*{k}} \hat{c}_{\vb*{k}\sigma}^\dagger \hat{c}_{\vb*{k} \sigma} + \sum_\sigma \epsilon_\text{d} \hat{c}_{\text{d}\sigma}^\dagger \hat{c}_{\text{d} \sigma} + \sum_{\vb*{k}, \sigma} V_{\vb*{k} \text{d}} \hat{c}_{\vb*{k} \sigma}^\dagger \hat{c}_{\text{d} \sigma} + \text{h.c.} + U \hat{n}_{\text{d} \uparrow} \hat{n}_{\text{d} \downarrow}.
    \label{eq:impurity-anderson}
\end{equation}
不失一般性地认为$V_{\vb*{k} \text{d}}$都是实数，如果它不是实数，那总是可以通过重新定义$\hat{c}_{\vb*{k} \text{d}}$（乘上一个复数因子）来让它变成实数。
最后一项是因为同处于d能级的两个电子之间会有库伦排斥作用，这一项实际上是唯一的真正的相互作用，因为前三项都是二次型。请注意这一项具有自选旋转不变性，这也是合理的。

d电子的相互作用项意味着d轨道上出现两个电子会大大增大能量，如果费米面位于d轨道出现一个电子和d轨道出现两个电子的能量之间，那么巡游电子总会填充d轨道，而且填充一个电子，其结果就是产生杂质附近的局域磁矩。

\[
    \Delta E \propto \frac{1}{\tau} \propto \sum_{\vb*{k}} \abs{V_{\vb*{k} \text{d}}}^2 N(\epsilon_\text{d}).
\]

当$U \gg \epsilon_\text{d} \gg \Delta E$时，展宽、良定义的局域磁矩

当$U \gg \Delta E \gg \epsilon_\text{d}$时能级已经很不清楚，和费米海混合的电子

\subsubsection{平均场近似}

相互作用项为
\[
    U \hat{n}_{\text{d} \uparrow} \hat{n}_{\text{d} \downarrow} = U \hat{c}_{\text{d} \uparrow}^\dagger \hat{c}_{\text{d} \uparrow} \hat{c}^\dagger_{\text{d} \downarrow} \hat{c}_{\text{d} \downarrow},
\]
现在尝试应用平均场近似。考虑其平均值并假定系统处在一个近似自由的态上，从而应用Wick定理，有
\[
    \begin{aligned}
        \expval{U \hat{n}_{\text{d} \uparrow} \hat{n}_{\text{d} \downarrow}} &= U \expval{\hat{c}_{\text{d} \uparrow}^\dagger \hat{c}_{\text{d} \uparrow} \hat{c}^\dagger_{\text{d} \downarrow} \hat{c}_{\text{d} \downarrow}} \\
        &= U ( \expval*{\hat{c}_{\text{d} \uparrow}^\dagger \hat{c}_{\text{d} \uparrow}} \expval*{\hat{c}_{\text{d} \downarrow}^\dagger \hat{c}_{\text{d} \downarrow}} + \expval*{\hat{c}_{\text{d} \uparrow}^\dagger \hat{c}_{\text{d} \downarrow}} \expval*{\hat{c}_{\text{d} \uparrow} \hat{c}^\dagger_{\text{d} \downarrow}} ),
    \end{aligned}
\]
第二项如果有非零值，$z$方向上的自旋旋转对称性就破缺了。
确实有这样的可能，就是系统基态有对称性自发破缺，但这里暂时假定没有这种情况。%
\footnote{我们也可以看到平均场近似总是倾向于高估系统的对称性破缺。}%
这样就有
\[
    \expval{U \hat{n}_{\text{d} \uparrow} \hat{n}_{\text{d} \downarrow}} = U \expval*{\hat{c}_{\text{d} \uparrow}^\dagger \hat{c}_{\text{d} \uparrow}} \expval*{\hat{c}_{\text{d} \downarrow}^\dagger \hat{c}_{\text{d} \downarrow}},
\]
这又告诉我们，我们有
\[
    \expval{U \hat{n}_{\text{d} \uparrow} \hat{n}_{\text{d} \downarrow}} = \expval{ U \hat{n}_{\text{d} \uparrow} \expval*{\hat{n}_{\text{d} \downarrow}} + U \expval*{\hat{n}_{\text{d} \uparrow}} \hat{n}_{\text{d} \downarrow} - U \expval*{\hat{n}_{\text{d} \uparrow}} \expval*{\hat{n}_{\text{d} \downarrow}} },
\]
那么如果相互作用哈密顿量适用平均场近似我们就有
\begin{equation}
    U \hat{n}_{\text{d} \uparrow} \hat{n}_{\text{d} \downarrow} \approx U \hat{n}_{\text{d} \uparrow} \expval*{\hat{n}_{\text{d} \downarrow}} + U \expval*{\hat{n}_{\text{d} \uparrow}} \hat{n}_{\text{d} \downarrow} - U \expval*{\hat{n}_{\text{d} \uparrow}} \expval*{\hat{n}_{\text{d} \downarrow}}.
\end{equation}
当然，这只是一种可能的平均场分解——没有理由认为这就是最理想的近似，但实际上使用变分计算可以确定这确实是最理想的近似。
忽略仅改变能量零点的常数项，得到平均场哈密顿量
\begin{equation}
    \hat{H}_\text{MF} = \sum_{\vb*{k}, \sigma} \epsilon_{\vb*{k}} \hat{c}_{\vb*{k}\sigma}^\dagger \hat{c}_{\vb*{k} \sigma} + \sum_\sigma \epsilon_\text{d} \hat{c}_{\text{d}\sigma}^\dagger \hat{c}_{\text{d} \sigma} + \sum_{\vb*{k}, \sigma} V_{\vb*{k} \text{d}} \hat{c}_{\vb*{k} \sigma}^\dagger \hat{c}_{\text{d} \sigma} + \text{h.c.} + U \hat{n}_{\text{d} \uparrow} \expval*{\hat{n}_{\text{d} \downarrow}} + U \expval*{\hat{n}_{\text{d} \uparrow}} \hat{n}_{\text{d} \downarrow}.
    \label{eq:anderson-mf}
\end{equation}
这是一个二次型哈密顿量。\eqref{eq:anderson-mf}含有不确定的平均场序参量$\expval*{\hat{n}_{\text{d} \uparrow}}$和$\expval*{\hat{n}_{\text{d} \downarrow}}$，但是可以将它们当成参数，求解出$\hat{n}_{\text{d} \uparrow}$和$\hat{n}_{\text{d} \downarrow}$之后回代，从而形成自洽方程。
这样求解出的$\expval*{\hat{n}_{\text{d} \uparrow}}$和$\expval*{\hat{n}_{\text{d} \downarrow}}$

求解\eqref{eq:anderson-mf}，在适当的条件上
% 但是这样还是破缺了自旋守恒。。那一开始的假设还是成立的吗？

可以对\eqref{eq:anderson-mf}做对角化。定义
\begin{equation}
    E_{\text{d} \sigma} = \epsilon_\text{d} + U \expval*{\hat{n}_{\text{d} (-\sigma)}},
\end{equation}
则
\begin{equation}
    \hat{H}_\text{MF} = \sum_{\vb*{k}, \sigma} \epsilon_{\vb*{k}} \hat{c}_{\vb*{k}\sigma}^\dagger \hat{c}_{\vb*{k} \sigma} + \sum_\sigma E_{\text{d} \sigma} \hat{c}_{\text{d}\sigma}^\dagger \hat{c}_{\text{d} \sigma} + \sum_{\vb*{k}, \sigma} V_{\vb*{k} \text{d}} \hat{c}_{\vb*{k} \sigma}^\dagger \hat{c}_{\text{d} \sigma} + \text{h.c.}
\end{equation}
可以直接使用成熟的矩阵方法来对角化这个哈密顿量。或者，采用下面的技巧：设已有对角化形式
\[
    \hat{H}_\text{MF} = \sum_{n, \sigma} \epsilon_{n \sigma} \hat{c}^\dagger_{n\sigma} \hat{c}_{n\sigma},
\]
其中$n$是某个未知的量子数。这样$\hat{c}_{n \sigma}$可以写成$\hat{c}_{\vb*{k} \sigma}$和$\hat{c}_{\text{d} \sigma}$的幺正变换，与此同时

\begin{equation}
    \begin{aligned}
        \epsilon_{n\sigma} \braket{\vb*{k}\sigma}{n \sigma} = \braket{\vb*{k} \sigma}{n \sigma} \epsilon_{\vb*{k}} + \braket{\text{d} \sigma}{n \sigma} V_{\vb*{k} \text{d}}, \\
        \epsilon_{n \sigma} \braket{\text{d} \sigma}{n \sigma} = \braket{\text{d} \sigma}{n \sigma} E_{\text{d} \sigma} + \sum_{\vb*{k}} \braket{\vb*{k} \sigma}{n \sigma} V_{\vb*{k} \sigma}.
    \end{aligned}
\end{equation}

\subsubsection{平均场近似下的格林函数}

由于系统自旋守恒，两个自旋不同的算符的格林函数为零，因此可以使用$G_{\text{dd}, \sigma}$标记d轨道电子的格林函数。
在$n$-$\sigma$表象下哈密顿量对角，于是使用$G_{n\sigma}$标记$n$表象电子的格林函数。
首先考虑松原格林函数，考虑到$n$表象下系统是自由的，有
\begin{equation}
    G_{n\sigma} (\omega_n) = \frac{1}{\ii \omega_n - \epsilon_n},
\end{equation}
请注意这里有两种$n$：$\omega_n$中的$n$标记频率，$\epsilon_n$和$G$的下标中的$n$则是量子数。
格林算符为
\begin{equation}
    \hat{G}(\omega_n) = \sum_{n, \sigma} \frac{\dyad{n\sigma}}{\ii \omega_n - \epsilon_n} = \frac{1}{\ii \omega_n - \hat{h}_\text{MF}},
\end{equation}
其中$\hat{h}_\text{MF}$就是单体哈密顿量，为
\begin{equation}
    \hat{h}_\text{MF} = \sum_{\vb*{k} \sigma} \epsilon_{\vb*{k}} \dyad{\vb*{k} \sigma} + \sum_\sigma E_{\text{d} \sigma} \dyad{\text{d} \sigma} + \sum_{\vb*{k}, \sigma} V_{\vb*{k} \text{d}} ( \ket{\vb*{k} \sigma} \bra{\text{d} \sigma} + \text{h.c.} ).
\end{equation}
由此可以计算出所有的格林函数。
格林算符的求解方式大致如下：我们有
\[
    (\ii \omega_n - \hat{h}_\text{MF}) \hat{G}(\omega_n) = 1,
\]
分别计算这个方程的不同矩阵元，可以得到
\begin{equation}
    (G_{\text{dd}, \sigma}(\omega_n))^{-1} = \ii \omega_n - E_{\text{d}\sigma} - \sum_{\vb*{k}} \frac{V_{\vb*{k}\text{d}}^2}{\ii \omega_n - \epsilon_{\vb*{k}}}.
\end{equation}
从以上松原格林函数可以容易地计算出推迟格林函数
\begin{equation}
    (G_{\text{dd}, \sigma}^\text{ret}(\omega))^{-1} = \omega - E_{\text{d}\sigma} - \sum_{\vb*{k}} \frac{V_{\vb*{k}\text{d}}^2}{\omega - \epsilon_{\vb*{k}} + \ii 0^+}.
\end{equation}
显然格林函数偏离了自由格林函数。自能为
\[
    \Sigma_{\text{d} \sigma} = \sum_{\vb*{k}} \frac{V_{\vb*{k}\text{d}}^2}{\omega - \epsilon_{\vb*{k}} + \ii 0^+}
\]
其虚部就是能级展宽的量级。可以把自能的实部归结到能级$E_{\text{d}\sigma}$中，因为后者是根本就不知道的。

\[
    A_{\text{d}\sigma} = \frac{1}{\pi} \frac{\Delta}{(\omega-E_{\text{d}\sigma})^2 + \Delta^2}
\]

\subsubsection{平均场自洽计算}

\subsubsection{Kondo效应}

在\eqref{eq:impurity-anderson}中$U > \abs{\epsilon_\text{d}} \gg V$时，d轨道上通常会有单个电子，从而导致一个局域磁矩。
我们使用平均场近似得到了一些定性的结果，本节则讨论在此基础上的涨落。
$U > \abs{\epsilon_\text{d}}$意味着空的d轨道、半满的d轨道、全满的d轨道分得非常开，因此我们只讨论仅涉及单满的d轨道的一个低能有效模型，为此需要把空的d轨道、全满的d轨道这两个态积掉。

\section{集体行为}

\subsection{一维电子系统的玻色化}

\subsubsection{费米点附近的有效理论}

考虑一个一维近独立电子系统。
一维系统的动量只有一个可能的方向。因此，一维系统的费米面无非是两个点。由对称性这两个点距离动量原点的位置是相同的。我们称它们为\textbf{费米点}。

考虑费米点附近的能量。使用巨正则系综并考虑扣除了化学势的有效哈密顿量，此时做线性近似，有
\begin{equation}
    \xi_{k} = \pm v_\text{F} (k - k_\text{F}).
\end{equation}
方程前面加正负号是因为色散关系是左右对称的，所以在两个费米点处的斜率互为相反数。
从费米面以下到费米面以上能量总是增加的，于是斜率为正表示$k>0$，斜率为负表示$k<0$。

我们将讨论费米点附近的低能有效理论，则晶格上的布洛赫产生湮灭算符中只有晶格动量集中在$\abs{k_\text{F}}$附近的部分是有意义的。
由于哈密顿量中不同动量的模式无耦合，可以直接弃去高动量模式，得到有效哈密顿量为
\[
    \hat{H}_\text{eff} = \sum_{\text{$k$ near $\pm k_\text{F}$}} \xi_k \hat{c}^\dagger_{k \sigma} \hat{c}_{k \sigma} = \sum_{\text{$k$ near $k_\text{F}$}} v_\text{F} (k - k_\text{F}) \hat{c}^\dagger_{k \sigma} \hat{c}_{k \sigma} - \sum_{\text{$k$ near $-k_\text{F}$}} v_\text{F} (k - k_\text{F}) \hat{c}^\dagger_{k \sigma} \hat{c}_{k \sigma}  ,
\]
为了简化，记
\begin{equation}
    p = \begin{cases}
        k - k_\text{F}, \quad k > 0, \\
        k_\text{F} - k, \quad k < 0,
    \end{cases}
\end{equation}
并使用$p$来标记布洛赫模式，则
\begin{equation}
    \hat{H}_\text{eff} = \sum_{\abs{p} < \Lambda} (v_\text{F} \abs{p} \hat{c}^\dagger_{ \text{L} p\sigma} \hat{c}_{\text{L} p\sigma} + v_\text{F} \abs{p} \hat{c}^\dagger_{ \text{R} p\sigma} \hat{c}_{\text{R} p\sigma}),
\end{equation}
其中$\Lambda$是一个截断参量，R和L分别表示对应的模式在$k>0$处（称为\textbf{右模式}），以及对应的模式在$k<0$处（称为\textbf{左模式}）。
在自由哈密顿量中不同自旋之间完全解耦，暂时只考虑一个自旋取值，于是
\begin{equation}
    \hat{H}_\text{eff} = \sum_{\abs{p} < \Lambda} (v_\text{F} p \hat{c}^\dagger_{\text{L} p} \hat{c}_{\text{L} p} + v_\text{F} p \hat{c}^\dagger_{\text{R} p} \hat{c}_{\text{R} p}).
    \label{eq:one-dimension-linear-model}
\end{equation}
若以$p$为动量，则$\hat{c}_{\text{R} p}$在坐标空间中对应着什么？容易发现，它对应的坐标空间中的湮灭算符正是$\hat{c}_{n\sigma}$以频率$\pm k_\text{F}$在空间上振荡的振幅，即
\begin{equation}
    \hat{c}_{n\sigma} = \ee^{\ii k_\text{F} na} \hat{c}_{\text{R} n \sigma } + \ee^{ - \ii k_\text{F} na} \hat{c}_{\text{L} n \sigma},
\end{equation}
它们在空间上是缓变的。% TODO：$\hat{\psi}_{\text{R}}(x)$？？

\subsubsection{玻色化}

首先考虑右模式的电子。
按照\eqref{eq:one-dimension-linear-model}，对一个能量本征态，将一个动量为$p$的右模式电子变为动量为$p+q$的右模式电子，则得到的结果仍然是一个能量本征态，且能量上升了$v_\text{F} q$。
而由于粒子数守恒，实际上任何一个能量本征态都可以通过“让费米海中的一些电子的动量增加”构造出来。这表明“将一个动量为$p$的右模式电子变为动量为$p+q$的右模式电子”是一个准粒子模式，其产生算符大体上如下：
\[
    \hat{b}_{\text{R} q}^\dagger \sim \sum_p \hat{c}^\dagger_{\text{R} (p+q)} \hat{c}_{\text{R} p} ,
\]
但是这样$p$可以取任何大的值，而低能有效理论\eqref{eq:one-dimension-linear-model}仅仅对比较小的$p$成立。
因此不出意外会产生一个发散的问题。例如，按照\eqref{eq:one-dimension-linear-model}费米海中实际上有无限多的电子，从而不受限制的对$p$求和会导致无穷大的结果。
可以在$\hat{b}_{\text{R} q}^\dagger$的表达式中引入一个截断，但是更好的做法实际上是使用正规排序。
设实空间的粒子数密度算符为
\[
    \hat{\rho}_\text{R}(x) = \hat{\psi}_\text{R}^\dagger(x) \hat{\psi}_\text{R}(x),
\]
它在动量空间的形式为%
\footnote{它不一定就是动量为$p$的粒子数。}%
\[
    \hat{\rho}_\text{R}(p) = \frac{1}{\sqrt{L}} \int \dd{x} \ee^{-\ii p x} \hat{\rho}_\text{R}(x) = \frac{1}{\sqrt{L}} \sum_k \hat{c}^\dagger_{\text{R} (k - p)} \hat{c}_{\text{R} k}.
\]
可以看到这个表达式和$\hat{b}^\dagger_{\text{R} p}$之间有线性关系，既然粒子数在没有截断时发散，$\hat{b}^\dagger_{\text{R} p}$必然也发散。
为了消除掉发散，重新定义粒子数密度算符为其原本的值的正规序：
\[
    \hat{\rho}_\text{R}(x) = \normalorder{\hat{\psi}_\text{R}^\dagger(x) \hat{\psi}_\text{R}(x)}, \quad \hat{\rho}_\text{R}(p) = \frac{1}{\sqrt{L}} \sum_k \normalorder{\hat{c}^\dagger_{\text{R} (k - p)} \hat{c}_{\text{R} k}}.
\]
计算对易关系得到
\[
    \comm*{\hat{\rho}_\text{R}(p)}{\hat{\rho}_\text{R}(p')} = - \frac{p}{2\pi} \delta_{pp'},
\]
这几乎就是一个玻色子对易关系了。缩放一下，定义
\[
    \hat{b}_{\text{R} p} = \sqrt{\frac{2\pi}{p}} \hat{\rho}_\text{R}(p), \quad \hat{b}^\dagger_{\text{R} p} = \sqrt{\frac{2\pi}{p}} \hat{\rho}_\text{R}(-p),
\]
就得到了正确的玻色子产生湮灭算符，它们描述的玻色子就是“将一个动量为$p$的右模式电子变为动量为$p+q$的右模式电子”这种模式。

现在我们需要反过来做正则量子化：在已经找到了一种粒子的产生湮灭算符之后，分析什么样的（定义在坐标空间中的）场能够产生这种粒子。
\[
    \hat{\phi}_\text{R}(p) = \frac{2\pi}{\ii p} \hat{\rho}_\text{R}(p),
\]
切换到坐标空间中就是
\[
    \hat{\rho}_\text{R}(x) = \frac{1}{2\pi} \grad \phi_\text{R}(x).
\]
我们写出场的傅里叶变换如下：
\[
    \phi_\text{R} (x) = \frac{1}{\sqrt{L}} \sum_p \ee^{- \alpha \abs{p} / 2} \phi_\text{R}(p) \ee^{\ii p x},
\]
这可以用来计算对易关系。

定义
\[
    \begin{bigcase}
        \hat{\phi}_\text{R} &= \hat{\phi} + \hat{\theta}, \\
        \hat{\phi}_\text{L} &= \hat{\phi} - \hat{\theta},
    \end{bigcase}
\]
通过$\hat{\rho}$的对易关系可以得到
\[
    \comm*{\hat{\phi}(x')}{\grad \hat{\theta}(x)} = -\ii \pi \delta(x' - x).
\]
中间其实还有很多对易关系？

写出
\[
    \hat{H} = v_\text{F} \sum_n p \hat{b}^\dagger_{\text{R} p} \hat{b}_{\text{R} p} + p \hat{b}^\dagger_{\text{L} p} \hat{b}_{\text{L} p}
\]
% TODO:这确实和\eqref{eq:one-dimension-linear-model}一致吗。。
\[
    H = \frac{v_\text{F}}{2\pi} \int \dd{x} (\grad{\phi})^2 + (\grad{\theta})^2
\]

有相互作用的体系经过玻色化之后也会得到同样的表达式
\[
    H = \frac{v_\text{F}}{2\pi} \int \dd{x} (\grad{\phi})^2 + (\grad{\theta})^2
\]

\[
    \hat{\psi}_\text{L} \sim \ee^{\ii \phi_\text{L}(x)}
\]

\subsection{超导}

数值计算或者手算二体问题会发现可能出现库伯对，然后以库珀对为序参量，做平均场分解，

\[
    - \frac{(\grad - \ii e \vb*{A})^2}{4 m^*} \Phi
\]
\[
    \vb*{j} \propto \Phi^* \grad{\Phi}
\]

超导的电流来自序参量的梯度，这和通常导电的机制（电场下费米面发生移动）不同。由于序参量是复的，即使不存在振幅输运，仅仅靠不同点相位不同就足够产生持续电流。这是一个稳态解，所以不存在能量消耗

\end{document}