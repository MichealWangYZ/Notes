\documentclass[hyperref, UTF8, a4paper]{ctexart}

\usepackage{geometry}
\usepackage{titling}
\usepackage{titlesec}
\usepackage{paralist}
\usepackage{footnote}
\usepackage{enumerate}
\usepackage{amsmath, amssymb, amsthm}
\usepackage{bbm}
\usepackage{cite}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{physics}
\usepackage{tikz}
\usepackage[colorlinks, linkcolor=black, anchorcolor=black, citecolor=black]{hyperref}
\usepackage{prettyref}

\geometry{left=3.18cm,right=3.18cm,top=2.54cm,bottom=2.54cm}
\titlespacing{\paragraph}{0pt}{1pt}{10pt}[20pt]
\setlength{\droptitle}{-5em}
\preauthor{\vspace{-10pt}\begin{center}}
\postauthor{\par\end{center}}

\DeclareMathOperator{\timeorder}{T}
\DeclareMathOperator{\diag}{diag}
\DeclareMathOperator{\legpoly}{P}
\DeclareMathOperator{\primevalue}{P}
\DeclareMathOperator{\sgn}{sgn}
\newcommand*{\ii}{\mathrm{i}}
\newcommand*{\ee}{\mathrm{e}}
\newcommand*{\const}{\mathrm{const}}
\newcommand*{\comment}{\paragraph{注记}}
\newcommand*{\suchthat}{\quad \text{s.t.} \quad}
\newcommand*{\argmin}{\arg\min}
\newcommand*{\argmax}{\arg\max}
\newcommand*{\normalorder}[1]{: #1 :}
\newcommand*{\pair}[1]{\langle #1 \rangle}
\newcommand*{\fd}[1]{\mathop{}\!\mathcal{D} #1}

\newrefformat{sec}{第\ref{#1}节}
\newrefformat{note}{注\ref{#1}}
\newrefformat{fig}{图\ref{#1}}
\renewcommand{\autoref}{\prettyref}

\usetikzlibrary{arrows,shapes,positioning}
\usetikzlibrary{arrows.meta}
\usetikzlibrary{decorations.markings}
\tikzstyle arrowstyle=[scale=1]
\tikzstyle directed=[postaction={decorate,decoration={markings,
    mark=at position .5 with {\arrow[arrowstyle]{stealth}}}}]
\tikzstyle ray=[directed, thick]
\tikzstyle dot=[anchor=base,fill,circle,inner sep=1pt]

\title{伊辛模型和统计场论}
\author{吴何友}

\begin{document}

\maketitle

本文如无说明，采用自然单位制。

\section{伊辛模型的定义}\label{sec:ising-def}

考虑一个$d$维空间中的晶格，共有$N$个格点。每个格点上有一个自旋。我们照惯例采用$z$方向的自旋来标记每个格点的状态，记之为$s_i$而省略$z$下标。
在\textbf{伊辛模型}中，假定：
\begin{enumerate}
    \item 格点$i$处的自选取值为$\pm 1$（具体值其实不重要，因为它们在尺度变换之下可以改变；关键是，自旋只有两个取值）；
    \item 只有相邻格点会发生相互作用；
    \item 自旋-自旋相互作用仅仅含有关于最近邻两格点的$\hat{s}_i \hat{s}_j$形式的项，也就是说，自旋的$x$和$y$分量不参与相互作用；\footnote{需要注意在实际的材料中这样的相互作用并不容易制备，但我们姑且假定相互作用是这样的形式。}
    \item 外部磁场和自旋线性耦合；
\end{enumerate}
由于不同格点的自旋算符显然是对易的，$\{s_i\}$表象就是系统的能量本征态，且
\begin{equation}
    E = - B \sum_i s_i - J \sum_{\pair{i,j}} s_i s_j.
    \label{eq:ising-energy}
\end{equation}
这里我们略去了第一项中的常数，把它们全部归入磁场中。

显然，在$J>0$且绝对值很大时，自旋倾向于同向排列，即形成一个\textbf{铁磁序}；而当$J<0$而绝对值很大时，自旋倾向于一上一下地排列，形成一个\textbf{反铁磁序}。

有限温下，我们写出\eqref{eq:ising-energy}对应的配分函数和热力学自由能：
\[
    Z(T, J, B) = \sum_{\{s_i\}} \ee^{- \beta E[s_i]}, \quad F_\text{thermo} = \expval{E} - TS  = - T \ln Z.
\]
原则上这就包含了关于系统的全部信息。

带有相互作用的配分函数通常很难计算。如果我们关心的只是比较大尺度上的磁化情况，那么其实并不需要完整的$\{s_i\}$。
定义$m(\vb*{x})$为在某个长度尺度$L$上平均化的$\{s_i\}$，$F[m(\vb*{x})]$是它对应的有效自由能。
也即，我们将$\{s_i\}$做空间傅里叶变换，把特征尺度小于$L$的成分全部积掉，就得到
\[
    F[m(\vb*{x})] = \sum_{\{s_i\} | m} E[s_i], \quad Z = \sum_m \ee^{-\beta F[m(\vb*{x})]}.
\]
当然的确存在这样的可能性，就是尺度低于$L$的自由度是积不掉的；但是直觉上似乎不会出现这种情况，而实际上也可以证明，确实不会出现。（见\autoref{sec:ab-initio-effective-theory}）

严格从\eqref{eq:ising-energy}出发计算$F[m(\vb*{x})]$一般是非常困难的。
通常我们使用朗道-金斯堡方法，即根据\eqref{eq:ising-energy}的对称性写出$F[m(\vb*{x})]$的普遍形式。
这样写出的$F[m(\vb*{x})]$中的各个常数都是没有确定的，要确定这些常数肯定需要从\eqref{eq:ising-energy}出发严格计算。
这些使用统计场论处理问题的方式见\autoref{sec:ising-effective-field}和\autoref{sec:ising-rg}。

\section{平均场处理方法}

\subsection{均匀系统}

本节讨论一个非常简单的情况：我们把截断尺度$L$选取到整个体系，从而使用一个单独的$m$描述整个体系。
此时
\begin{equation}
    m = \frac{1}{N} \sum_i s_i,
\end{equation}
容易看出$-1 < m < 1$，它就是平均磁化强度。实际上它是一个序参量，因为如果系统处于顺磁相那么$m$应该接近$1$或者$-1$，而如果系统处于无序相那么$m$应该接近$0$。
$m$本质上仍然是离散的，它能够发生的最小变化是一个$-1$格点变成$+1$，即它能够发生的最小变化是$2/N$。
在大$N$极限下有
\begin{equation}
    Z = \frac{N}{2} \int_{-1}^1 \dd{m} \ee^{-\beta F(m)}.
\end{equation}
下面要做的是计算出$F(m)$。我们假定系统充分均匀，则将\eqref{eq:ising-energy}中的所有$s_i$和$s_j$都使用$m$代替，从而得到
\begin{equation}
    \frac{E}{N} = - B m - \frac{1}{2} J q m^2,
    \label{eq:ising-energy-m-approx}
\end{equation}
其中$q$是每个格点周围最近邻格点的数目，和维数有关。请注意这一步近似\eqref{eq:ising-energy-m-approx}的可靠性完全没有保障：我们并不知道$\{s_i\}$的涨落情况，自然不可能知道将它们全部替换成$m$之后是不是能够得到足够精确的结果。
正如通常的平均场理论一样，这只是一个近似的起步，需要在此基础上逐阶考虑涨落的影响。
不过我们还是先姑且按照这个假设算下去，仅仅因为它方便处理。
由定义可以得到
\[
    m = \frac{N_\uparrow - N_\downarrow}{N} = \frac{2N_\uparrow - N}{N}, \quad \Omega = \frac{N!}{N_\uparrow!(N-N_\uparrow)!},
\]
使用斯特林公式可以计算出以下近似值
\begin{equation}
    \ln\Omega(m) = - \frac{m+1}{2} N \ln\frac{m+1}{2} - \frac{1-m}{2} N \ln\frac{1-m}{2},
    \label{eq:lattice-entropy}
\end{equation}
设$f(m)$为平均每个格点的有效自由能，则根据
\[
    \ee^{-\beta F(m)} = \Omega(m) \ee^{-\beta E},
\]
即
\[
    -\beta N f(m) = \ln \Omega(m) - \beta E,
\]
可以计算出
\begin{equation}
    f(m) = - Bm - \frac{1}{2} J q m^2 + T \left( \frac{m+1}{2} \ln(m+1) + \frac{1-m}{2} \ln(1-m) - \ln 2 \right).
    \label{eq:free-energy-of-m}
\end{equation}
取鞍点近似，由于$F(m)$的极小值就是$f(m)$的极小值，我们有
\[
    \eval{\pdv{f}{m}}_{m=\expval*{m}} = 0,
\]
于是发现热平衡时的平均自旋$\expval*{m}$满足
\begin{equation}
    m = \tanh(\beta B + \beta J q m).
    \label{eq:self-consistency-m-approx}
\end{equation}
我们得到了一个自洽方程。

\subsection{平均场分解}

实际上，也可以显式地将相互作用项做平均场分解来得到\eqref{eq:self-consistency-m-approx}：做分解
\begin{equation}
    \begin{aligned}
        s_i s_j &\approx \expval*{s_i} s_j + s_i \expval*{s_j} - \expval*{s_i} \expval*{s_j} \\
        &\approx \expval*{m} (s_i + s_j) - \expval*{m}^2,
    \end{aligned}
    \label{eq:mf-decomp}
\end{equation}
其中第二个约等号表示系统的均匀性，即每个点的自选取值都和$m$相差不大，并注意到
\[
    \sum_i s_i = N m,
\]
\[
    \sum_{\pair{i,j}} \expval*{m} s_i = \frac{1}{2} \expval*{m} q \sum_i s_i = \frac{1}{2} \expval*{m} q N m,
\]
而
\[
    \sum_{\pair{i,j}} m^2 = \frac{1}{2} \expval*{m}^2 q N,
\]
则得到平均场哈密顿量
\begin{equation}
    E = - B N m - J q N \expval*{m} m + \frac{1}{2} J q N \expval*{m}^2.
    \label{eq:ising-mean-field-energy}
\end{equation}
可以看到除了一个常数项以外，相当于有一个大小为
\begin{equation}
    B_\text{eff} = B + J q \expval*{m}
\end{equation}
的场被作用在了$m$上。使用\eqref{eq:ising-mean-field-energy}连同\eqref{eq:lattice-entropy}，根据热力学第一定律就可以推导出\eqref{eq:self-consistency-m-approx}。
这也就是我们称它为平均场解的原因。

\subsection{相变}

我们只是知道\eqref{eq:self-consistency-m-approx}给出了所有解，但是并不知道这些解有几个，是不是稳定等。
回顾\eqref{eq:free-energy-of-m}，做泰勒展开得到
\begin{equation}
    f(m) = - T \ln 2 - Bm + \frac{1}{2} (T-Jq) m^2 + \frac{1}{12} T m^4 + \cdots,
    \label{eq:mf-free-energy-series-m}
\end{equation}
在$m$和$B$均不大时取开头四项已经足够确定自由能曲线的形状了。

\subsubsection{无磁场情况下的二级相变}

\begin{figure}
    \centering
    \subfigure[$T>T_\text{c}$的自由能曲线]{
        \begin{tikzpicture}
            
            % m横轴
            \draw[->] (-2.5,0) -- (2.5,0) node[right] {$m$};
            % 自由能纵轴
            \draw[->] (0,-0.5) -- (0,5.5) node[above] {$f(m)$};
            
            % 画出自由能
            \draw[samples=50, smooth, domain=-2.2:2.2] plot(\x,{0.5*(\x*\x)+0.11*(\x*\x*\x*\x)});
    
            % 标出极小值点
            \node[circle,fill,inner sep=1.5pt] at (0, 0) {};
    
        \end{tikzpicture}
        \label{fig:small-t-free-energy}
    }
    \subfigure[$T<T_\text{c}$的自由能曲线]{
        \begin{tikzpicture}
            
            % m横轴
            \draw[->] (-2.5,0) -- (2.5,0) node[right] {$m$};
            % 自由能纵轴
            \draw[->] (0,-1.5) -- (0,4.5) node[above] {$f(m)$};
            
            % 画出自由能
            \draw[samples=50, smooth, domain=-2.2:2.2] plot(\x,{-0.5*(\x*\x)+0.25*(\x*\x*\x*\x)});
    
            % 标出极小值点
            \node[circle,fill,inner sep=1.5pt] at (1, -0.25) {};
            \node[circle,fill,inner sep=1.5pt] at (-1, -0.25) {};
    
        \end{tikzpicture}
        \label{fig:big-t-free-energy}
    }
    \caption{不同形状的自由能曲线}
    \label{fig:chemical-potential}
\end{figure}

在$B=0$时$m=0$肯定是一个极小值点，稳定不稳定暂时不论。
略去自由能中无关紧要的常数项，$T-Jq$的正负决定了曲线在$m=0$附加是上凸还是下凹。
如果它是正的，那么曲线下凹，而由于四次方项也是正的，整个曲线都是下凹的，也就是说只有$m=0$一个极小值点，而且这是稳定的极小值点，如\autoref{fig:small-t-free-energy}。
如果它是负的那么曲线在$m=0$附近上凸，$m=0$不是稳定解，于是出现两个极小值点，如\autoref{fig:big-t-free-energy}。

这意味着在$B=0$时，当$T$经过
\begin{equation}
    T_\text{c} = Jq
\end{equation}
时出现了一个相变，因为随着$T$的增大，不为零的序参量$m$变为零且一直停留在零。
在\autoref{fig:big-t-free-energy}中出现了自发对称性破缺，原本具有的自旋翻转对称性被破缺了。
因此$T<T_\text{c}$时出现了一个铁磁序，这个铁磁序破缺了自旋翻转对称性；$T>T_\text{c}$对应一个无序相。
计算稳态时序参量$m$的值，可以得到
\begin{equation}
    m = \begin{cases}
        \pm \sqrt{\frac{3(T_\text{c}-T)}{T}}, \quad T < T_\text{c}, \\
        0, \quad T > T_\text{c},
    \end{cases}
    \label{eq:mf-stable-m}
\end{equation}
上式绘图如\autoref{fig:mf-m-and-t-relation}。

\begin{figure}
    \centering
    \begin{tikzpicture}
            
        % T横轴
        \draw[->] (-1,0) -- (6,0) node[right] {$T$};
        % 磁化强度纵轴
        \draw[->] (0,-3) -- (0,3) node[above] {$m$};
        
        % 绘制铁磁相的曲线
        \draw[samples=50, smooth, thick, domain=0:2.5] plot(\x, {sqrt(2.5-\x)});
        \draw[samples=50, smooth, thick, domain=0:2.5] plot(\x, {-sqrt(2.5-\x)});

        % 绘制无序相的曲线
        \draw[thick] (2.5, 0) -- (5,0);

        % 标出极小值点
        \node[dot, label=above right:$T_\text{c}$] at (2.5, 0) {};

    \end{tikzpicture}
    \caption{稳态时磁化强度序参量和温度的关系}
    \label{fig:mf-m-and-t-relation}
\end{figure}
\autoref{fig:mf-m-and-t-relation}中$x$轴和$y$轴的交点不是零；
我们没有把$T$外推到$0$，因为显然此时\eqref{eq:mf-stable-m}是错误的——它没有能够保证$-1<m<1$，而是给出了发散的结果。

在$T_\text{c}$附近的相变实际上是一个二级相变。这是因为$m$是连续的，而$F(m)$是$m$的函数，从而也是连续的；但是$F(m)$并不光滑，因为\eqref{eq:mf-stable-m}并不光滑，因此$F(m)$的导数不连续，从而是二级相变。

\subsubsection{一级相变}

上一节的结果都是假定了$B=0$，然后在这条等磁线上我们有一个二级相变。显然按照\eqref{eq:free-energy-of-m}，磁场变化会让自由能的极小值点发生偏移，如\autoref{fig:mf-b-and-free-energy}所示。
当$T>T_\text{c}$时，只有一个偏离$m=0$的稳定极小值点；当$T<T_\text{c}$时，两个极小值点中的一个的自由能变高，变为亚稳态，或者甚至直接变成鞍点，而另一个则为全局最小值。
$B>0$时和$B<0$时热力学稳态分别位于$m>0$和$m<0$位置，$m$本身就不连续，因此这是一个一级相变。
当$T>T_\text{c}$时随着$B$的变化热力学稳态是连续变化的，即不存在相变。

\begin{figure}
    \centering
    \subfigure[$T>T_\text{c}, B>0$的自由能曲线]{
        \begin{tikzpicture}
            
            % m横轴
            \draw[->] (-2,0) -- (2.5,0) node[right] {$m$};
            % 自由能纵轴
            \draw[->] (0,-0.5) -- (0,5.5) node[above] {$f(m)$};
            
            % 画出自由能
            \draw[samples=50, smooth, domain=-1.9:2.5] plot(\x,{-1*\x+0.5*(\x*\x)+0.11*(\x*\x*\x*\x)});
    
            % 标出极小值点
            \node[circle,fill,inner sep=1.5pt] at (0.82, -0.43) {};
    
        \end{tikzpicture}
        \label{fig:small-t-positive-b-free-energy}
    }
    \subfigure[$T>T_\text{c}, B>0$的自由能曲线]{
        \begin{tikzpicture}
            
            % m横轴
            \draw[->] (-2.5,0) -- (2,0) node[right] {$m$};
            % 自由能纵轴
            \draw[->] (0,-0.5) -- (0,5.5) node[above] {$f(m)$};
            
            % 画出自由能
            \draw[samples=50, smooth, domain=-2.5:1.9] plot(\x,{1*\x+0.5*(\x*\x)+0.11*(\x*\x*\x*\x)});
    
            % 标出极小值点
            \node[circle,fill,inner sep=1.5pt] at (-0.82, -0.43) {};
    
        \end{tikzpicture}
        \label{fig:small-t-negative-b-free-energy}
    }
    \subfigure[$T<T_\text{c}, B>0$的自由能曲线]{
        \begin{tikzpicture}
            
            % m横轴
            \draw[->] (-2.5,0) -- (2.5,0) node[right] {$m$};
            % 自由能纵轴
            \draw[->] (0,-1.5) -- (0,4.5) node[above] {$f(m)$};
            
            % 画出自由能
            \draw[samples=50, smooth, domain=-2.2:2.2] plot(\x,{-0.25*\x-0.5*(\x*\x)+0.25*(\x*\x*\x*\x)});
    
            % 标出极小值点
            \node[circle,fill,inner sep=1.5pt] at (1.11, -0.51) {};
    
        \end{tikzpicture}
        \label{fig:big-t-positive-b-free-energy}
    }
    \subfigure[$T<T_\text{c}, B<0$的自由能曲线]{
        \begin{tikzpicture}
            
            % m横轴
            \draw[->] (-2.5,0) -- (2.5,0) node[right] {$m$};
            % 自由能纵轴
            \draw[->] (0,-1.5) -- (0,4.5) node[above] {$f(m)$};
            
            % 画出自由能
            \draw[samples=50, smooth, domain=-2.2:2.2] plot(\x,{0.25*\x-0.5*(\x*\x)+0.25*(\x*\x*\x*\x)});
    
            % 标出极小值点
            \node[circle,fill,inner sep=1.5pt] at (-1.11, -0.51) {};
    
        \end{tikzpicture}
        \label{fig:big-t-negative-b-free-energy}
    }
    \caption{磁场变化导致自由能曲线变化}
    \label{fig:mf-b-and-free-energy}
\end{figure}

这就意味着，我们可以得到如\autoref{fig:mf-phase-diagram}所示的相图：$T<T_\text{c}$时有明确区分的两相，$B=0$为两相共存曲线；而$T>T_\text{c}$时两相混合。$T=T_\text{c},B=0$为临界点。这和水的气液相变的相图非常相似。

\begin{figure}
    \centering
    \begin{tikzpicture}
            
        % T横轴
        \draw[->] (0,0) -- (5,0) node[right] {$T$};
        % B纵轴
        \draw[->] (0,-2) -- (0,2) node[above] {$B$};
        
        % 相变曲线
        \draw[thick] (0, 0) -- (2,0);

        % 标出二级相变点
        \node[dot, label=above:$T_\text{c}$] at (2, 0) {};

        % 标出两相
        \node[] at (1, 1) {$m>0$};
        \node[] at (1, -1) {$m<0$};
        \node[] at (4, 0.5) {disordered};

    \end{tikzpicture}
    \caption{平均场理论下的相图}
    \label{fig:mf-phase-diagram}
\end{figure}

\subsubsection{临界指数}

现在分析临界点附近不同物理量的发散行为，即计算临界指数。

磁化率定义为
\[
    \chi = \eval{\pdv{m}{B}}_{T},
\]
在$T>T_\text{c}$时稳定的$m$只有一个，因此可以直接对\eqref{eq:free-energy-of-m}求导取零点。
在磁场不大时略去常数项，有
\[
    f(m) \approx - B m + \frac{1}{2} (T-T_\text{c})^2 m^2,
\]
得到
\[
    m = \frac{B}{T-T_\text{c}}.
\]
在$T<T_\text{c}$时稳定的$m$即使在$B=0$时也不为零。设$m_0$为\eqref{eq:mf-stable-m}预言的$m$，实际的$m$由于磁场的加入会有一个小的偏差，于是
\[
    \begin{aligned}
        0 = \dv{f}{m} &\approx - B + (T - T_\text{c}) (m_0 + \var{m}) + \frac{1}{3} T (m_0 + \var{m})^3 \\
        &\approx - B + (T-T_\text{c}) (m_0 + \var{m}) + \frac{1}{3} T (m_0^3 + 3 m_0^2 \var{m}) \\
        &= - B + 2(T-T_\text{c}) \var{m},
    \end{aligned}
\]
从而
\[
    m \approx m_0 + \frac{B}{2(T-T_\text{c})},
\]
于是在临界点附近固定$B=0$而变动$T$，可以得到
\begin{equation}
    \chi \sim \frac{1}{\abs{T-T_\text{c}}} = \frac{1}{\abs{T-T_\text{c}}^\gamma}, \quad \gamma = 1. 
\end{equation}

再来看$m$的临界情况。若$T=T_\text{c}$，则由\eqref{eq:mf-free-energy-series-m}，略去高阶项，得到
\begin{equation}
    m \sim \abs*{B}^{1/3} = \abs*{B}^{1/\delta}, \quad \delta = 3.
\end{equation}
此即固定$T=T_\text{c}$，让磁场接近零而得到的临界指数。
若固定$B=0$，则可以直接套用\eqref{eq:mf-stable-m}，得到
\begin{equation}
    m \sim (T_\text{c}-T)^{1/2} = (T_\text{c}-T)^\beta, \quad \beta = \frac{1}{2}.
\end{equation}

最后是热容。单位粒子数的热容为
\[
    c = - T \pdv[2]{f}{T},
\]
在临界点附近有
\[
    f \approx \frac{1}{2} (T-T_\text{c}) m^2 + \frac{1}{12} T m^4 
    = \begin{cases}
        \frac{3}{4} \frac{(T_\text{c}-T)^2}{T}, &\quad T < T_\text{c}, \\
        0, &\quad T > T_\text{c},
    \end{cases},
\]
则
\begin{equation}
    c = \begin{cases}
        3/2, &\quad T < T_\text{c}, \\
        0, &\quad T > T_\text{c}, 
    \end{cases}
    \quad c \sim \abs*{T-T_\text{c}}^{-\alpha}, \quad \alpha = 0.
\end{equation}

\subsection{平均场理论的可靠性}

以上给出的平均场理论可能会因为以下几个原因而不精确：
\begin{enumerate}
    \item 平均场的假设本身就是错误的，也即，与一个格点发生相互作用的其它格点不能用平均的$m$代替；
    \item 平均场的假设本身是正确的，但是采取了错误的平均场，例如不应该做分解\eqref{eq:mf-decomp}而应该使用别的方法；
    \item 将整个系统用一个序参量$m$代替忽略了太多信息，可能不能得到一个良定义的有效理论。
\end{enumerate}

关于第一个原因，随着维数增大，每个格点周围的格点变多，因此相互作用也就越接近平均场理论的预言。
在伊辛模型中，
\begin{itemize}
    \item $d=1$时平均场理论完全是错的，根本就没有相变；
    \item $d=2,3$时平均场理论给出了定性大致正确的结果，但是临界指数之类的细节都是错的；
    \item $d \geq 4$时平均场理论是对的。
\end{itemize}

% TODO:第二个原因

消除第三个原因的尝试则要求我们更加精确地考虑怎么样对系统做粗粒化，这也就引出了\autoref{sec:ising-effective-field}。

\section{伊辛模型的有效场论}\label{sec:ising-effective-field}

\subsection{金斯堡-朗道理论}

\subsubsection{对称性和自由能的形式}

在\autoref{sec:ising-def}中我们提到可以使用一个局域的平均磁化强度$m(\vb*{x})$来描述系统状态，它是更加精细的$m$。
直接从定义出发得到关于$m(\vb*{x})$的有效理论的方法见\autoref{sec:ab-initio-effective-theory}，本节讨论怎样使用金斯堡-朗道方法，从对称性出发得到一个有效理论。

临界点附近有尺度不变性，由于$m(\vb*{x})$是将$\{s_i\}$粗粒化之后得到的结果，在临界点附近可以放心地只保留$m(\vb*{x})$来描述系统状态，即只使用此局域序参量来描述系统状态。
在没有磁场，且晶格为正方晶格时，一个$d=2, 3$维的有效理论应该满足：
\begin{enumerate}
    \item 首先伊辛模型是局域的，所以总是可以写出
    \[
        F[m(\vb{x})] = \int \dd[d]{\vb{x}} f(m(\vb{x}), \grad{m}, \ldots).
    \]
    显然梯度项决定了每一个点如何影响附近的点。
    \item 平移和旋转对称性。正方晶格具有离散的平移和旋转不变性，当$L$取得相对于晶格常数来说很大时，这两个对称性就是连续的。
    \item $\mathbb{Z}(2)$对称性，即自旋翻转不变，在这里就是在
    \[
        m(\vb{x}) \longrightarrow -m(\vb{x})
    \]
    下不变。当然磁场的加入会破坏这个对称性。
    \item 解析性。$F[m]$显然关于$m$是解析的，因为每个格点的自旋可以随意翻转，对自由能产生有界的影响。假定$m(\vb{x})$变化平缓，从而自由能关于$\grad{m}$也是解析的。
\end{enumerate}

$\mathbb{Z}_2$对称性意味着$f$的每一项都应该是偶数次项，从而我们做泰勒展开：
\begin{equation}
    f = \frac{1}{2} \alpha_2(T) m^2 + \frac{1}{4} \alpha_4(T) m^4 + \frac{1}{2} \gamma(T) (\grad{m})^2 + \cdots,
    \label{eq:gl-free-energy}
\end{equation}
由于常数项只会让配分函数多一个常数因子，已经略去。
没有出现形如$\vb*{a} \cdot \grad{m}$这样的项，因为这会引入一个特殊的空间方向。没有取太高阶的$m^n$项是因为$m$并不是很大，只需要前几项；没有取太高阶的导数项或者$(\grad{m})^n$项是因为这些项的量纲很快会超出$d$的范围，从而这些项在重整化下是无关的。

\subsubsection{鞍点近似}

首先使用和平均场理论类似的粗糙手段处理\eqref{eq:gl-free-energy}，而先不计算路径积分。完整的路径积分计算见\autoref{sec:path-integral}。

\subsection{直接做平均}\label{sec:ab-initio-effective-theory}

\subsubsection{Hubbard–
Stratonovich变换}

本节尝试直接从哈密顿量\eqref{eq:ising-energy}出发计算配分函数并得到一个有效场论。
我们将\eqref{eq:ising-energy}写成如下矩阵形式：
\begin{equation}
    E = - \vb{B}^\top \vb{s} - \frac{1}{2} \vb{s}^\top \vb{J} \vb{s}, 
\end{equation}
其中$\vb{B}$的每个元素的值都是$B$，而$\vb{J}$是对称矩阵，只在$i$和$j$代表相邻格点时$J_{ij}$取值$J$，其余为零，则
\[
    Z = \sum_{\{s_i\}} \exp(\beta \vb{B}^\top \vb{s} + \frac{1}{2} \beta \vb{s}^\top \vb{J} \vb{s}).
\]
使用高斯积分公式
\[
    \int \fd{\vb{x}} \exp(-\frac{1}{2} \vb{x}^\top \vb{A} \vb{x} + \vb{x}^\top \vb{s}) 
    = \prod_{i=1}^N \int_{-\infty}^\infty \frac{\dd{x_i}}{\sqrt{2\pi}} \exp(-\frac{1}{2} \vb{x}^\top \vb{A} \vb{x} + \vb{x}^\top \vb{s}) = \frac{1}{\sqrt{\det \vb{A}}} \ee^{\frac{1}{2} \vb{s}^\top \vb{A}^{-1} \vb{s}},
\]
得到
\[
    \exp(\frac{1}{2} \beta \vb{s}^\top \vb{J} \vb{s}) = \frac{\int \fd{\vb{x}} \exp(- \frac{1}{2} T \vb{x}^\top \vb{J}^{-1} \vb{x} + \vb{x}^\top \vb{s})}{\int \fd{\vb{x}} \exp(- \frac{1}{2} T \vb{x}^\top \vb{J}^{-1} \vb{x} )}.
\]
我们完成了一个Hubbard–Stratonovich变换，引入了一个辅助场$\vb{x}$。将上式代入配分函数的表达式，就得到
\[
    Z = \frac{\int \fd{\vb{x}} \exp(-\frac{1}{2} T \vb{x}^\top \vb{J}^{-1} \vb{x}) \sum_{\{s_i\}} \exp(\beta \vb{B}^\top \vb{s} + \vb{x}^\top \vb{s})}{\int \fd{\vb{x}} \exp(-\frac{1}{2} T \vb{x}^\top \vb{J}^{-1} \vb{x})}.
\]
注意到
\[
    \int \fd{\vb{x}} \exp(-\frac{1}{2} T \vb{x}^\top \vb{J}^{-1} \vb{x}) = \frac{1}{\sqrt{\det \vb{J}^{-1}}}
\]
是一个常数，不显含$\vb{x}$和$\vb{s}$，于是略去它，得到等效的（略去了一个无用常数的）配分函数
\begin{equation}
    Z = \int \fd{\vb{x}} \exp(-\frac{1}{2} T \vb{x}^\top \vb{J}^{-1} \vb{x}) \sum_{\{s_i\}} \exp(\beta \vb{B}^\top \vb{s} + \vb{x}^\top \vb{s}).
    \label{eq:partition-function-x-s}
\end{equation}
按照下面的方法积掉$\vb{s}$：
\[
    \begin{aligned}
        \sum_{\{s_i\}} \exp(\beta \vb{B}^\top \vb{s} + \vb{x}^\top \vb{s}) &= \prod_{i=1}^N \sum_{s_i = \pm 1} \exp(\beta B s_i + x_i s_i) \\
        &= \prod_{i=1}^N 2\cosh(\beta B + x_i) \\
        &= \exp(\sum_{i=1}^N \ln(2\cosh(\beta B + x_i))),
    \end{aligned}
\]
就得到
\begin{equation}
    Z = \int \fd{\vb{x}} \ee^{-\tilde{S}}, \quad \tilde{S} = \frac{1}{2} T \vb{x}^\top \vb{J}^{-1} \vb{x} - \sum_{i=1}^N \ln(2\cosh(\beta B + x_i)),
    \label{eq:action-of-x}
\end{equation}
上式中的$Z$是\eqref{eq:partition-function-x-s}中的$Z$，不是一开始定义的$Z$，因为略去了一个常数因子。
这里的热力学作用量已经是约化过的，不是关于$\{s_i\}$而是关于$\vb{x}$的了。

到现在为止我们对$\vb{x}$到底是什么还不得而知。所以我们改用\eqref{eq:partition-function-x-s}计算$\vb{x}$的期望值，这就是
\[
    \begin{aligned}
        \expval*{\vb{x}} &= \lim_{\vb{y} \to 0} \pdv{\vb{y}} \frac{\int \fd{\vb{x}} \exp(-\frac{1}{2} T \vb{x}^\top \vb{J}^{-1} \vb{x} + \vb{y}^\top \vb{x}) \sum_{\{s_i\}} \exp(\beta \vb{B}^\top \vb{s} + \vb{x}^\top \vb{s})}{\int \fd{\vb{x}} \exp(-\frac{1}{2} T \vb{x}^\top \vb{J}^{-1} \vb{x}) \sum_{\{s_i\}} \exp(\beta \vb{B}^\top \vb{s} + \vb{x}^\top \vb{s})} \\
        &= \lim_{\vb{y} \to 0} \pdv{\vb{y}} \frac{\sum_{\{s_i\}} \exp(\beta \vb{B}^\top \vb{s} + \frac{1}{2} \beta (\vb{s} + \vb{y})^\top \vb{J} (\vb{s} + \vb{y}))}{\sum_{\{s_i\}} \exp(\beta \vb{B}^\top \vb{s} + \frac{1}{2} \beta \vb{s}^\top \vb{J} \vb{s})} \\
        &= \lim_{\vb{y} \to 0} \pdv{\vb{y}} \frac{\sum_{\{s_i\}} \exp(\beta \vb{B}^\top \vb{s} + \frac{1}{2} \beta \vb{s}^\top \vb{J} \vb{s} + \beta \vb{y}^\top \vb{J} \vb{s} + \frac{1}{2} \beta \vb{y}^\top \vb{J} \vb{y} )}{\sum_{\{s_i\}} \exp(\beta \vb{B}^\top \vb{s} + \frac{1}{2} \beta \vb{s}^\top \vb{J} \vb{s})} \\
        &= \frac{\sum_{\{s_i\}} \exp(\beta \vb{B}^\top \vb{s} + \frac{1}{2} \beta \vb{s}^\top \vb{J} \vb{s}) \beta \vb{J} \vb{s}}{\sum_{\{s_i\}} \exp(\beta \vb{B}^\top \vb{s} + \frac{1}{2} \beta \vb{s}^\top \vb{J} \vb{s})} \\
        &= \beta \vb{J} \expval*{\vb{s}}.
    \end{aligned}
\]
第二个等号处我们把$\vb{x}$积掉了。上式说明$\expval*{\vb{x}}$实际上正比于$\vb{s}$的期望值。这样重新定义
\begin{equation}
    \vb{\varphi} = T \vb{J}^{-1} \vb{x},
\end{equation}
则\eqref{eq:action-of-x}应改写为
\begin{equation}
    Z = \int \fd{\vb{\varphi}} \ee^{-\tilde{S}}, \quad \tilde{S} = \frac{\beta}{2} \sum_{i,j} \varphi_i J_{ij} \varphi_j - \sum_{i=1}^N \ln(2\cosh(\beta(B + \sum_{j=1}^N J_{ij} \varphi_j))).
\end{equation}
这里的$\vb{\varphi}$和$\vb{s}$是等效的，但是写成上式便于实施截断，从而得到一个有效场论。

有一个比较微妙的地方：由于我们并不知道$\vb{\varphi}$和$\vb{s}$的涨落的关系，一般来说总是有
\[
    \expval{\varphi_{i_1} \varphi_{i_2} \cdots \varphi_{i_n}} \neq \expval{s_{i_1} s_{i_2} \cdots s_{i_n}}.
\]
但使用\eqref{eq:partition-function-x-s}可以发现，两者相差的所有项都正比于$J_{ij}$，而当$i_1, i_2, \ldots$基本上不相邻时这些项都是零。因此只要$i_1, i_2, \ldots$分布足够稀疏，我们都可以将$\vb{\varphi}$和$\vb{s}$视为相同。

\subsubsection{截断}

\section{路径积分和微扰论}\label{sec:path-integral}

\section{伊辛模型的重整化群}\label{sec:ising-rg}

\end{document}