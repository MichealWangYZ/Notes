\documentclass[hyperref, UTF8, a4paper]{ctexart}

\usepackage{geometry}
\usepackage{titling}
\usepackage{titlesec}
\usepackage{paralist}
\usepackage{footnote}
\usepackage{enumerate}
\usepackage{amsmath, amssymb, amsthm}
\usepackage{cite}
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{physics}
\usepackage{tikz}
\usepackage[colorlinks, linkcolor=black, anchorcolor=black, citecolor=black]{hyperref}
\usepackage{prettyref}

\geometry{left=3.18cm,right=3.18cm,top=2.54cm,bottom=2.54cm}
\titlespacing{\paragraph}{0pt}{1pt}{10pt}[20pt]
\setlength{\droptitle}{-5em}
\preauthor{\vspace{-10pt}\begin{center}}
\postauthor{\par\end{center}}

\DeclareMathOperator{\timeorder}{T}
\DeclareMathOperator{\diag}{diag}
\newcommand*{\ii}{\mathrm{i}}
\newcommand*{\ee}{\mathrm{e}}
\newcommand*{\const}{\mathrm{const}}
\newcommand*{\comment}{\paragraph{注记}}

\newrefformat{sec}{第\ref{#1}节}
\newrefformat{note}{注\ref{#1}}
\renewcommand{\autoref}{\prettyref}

\newenvironment{bigcase}{\left\{\quad\begin{aligned}}{\end{aligned}\right.}

\title{统计物理}
\author{wujinq}

\begin{document}

\maketitle

% TODO：各态遍历假设、复合系统、从量子到经典

\section{统计力学的理论框架}

我们将讨论量子系统的统计力学。本文中我们将采用标准的关于“测量”的理论而不分析其背后的原理。
使用$\{\ket{n}\}$表示系统态空间的一组完备正交基。

\subsection{混合态和密度算符}

\subsubsection{引入密度算符}\label{sec:introduction-of-density-operator}

很多量子系统——即使简单如一个单粒子——的态空间都可以分解成一些态空间的直积。
一些时候我们只是关心整个系统的一部分。因此，接下来称我们关心的这部分为\textbf{系统}，称我们不关心的部分为\textbf{环境}。
我们设环境完全被算符$\hat{B}$描述而$\hat{A}$是关于系统的一个算符，则系统-环境对的态可以写成这样：
\begin{equation}
    \ket{\text{sys-env}} = \sum_i c_i \ket{\psi_i} \ket{B_i}.
    \label{eq:sys-env-state}
\end{equation}
也就是说我们把系统-环境对的态中含有的所有项都整理成以上形式。
我们还假定系统的演化独立于环境，
这或者是因为环境对系统的作用并不强以至于可以忽略，或者是因为环境对系统的作用如此之强以至于其结果可以很容易地知道而不需要考虑环境的内部状态（例如，考虑原子核对电子的作用）。
然而，虽然系统和环境之间没有耦合，但在制备系统的时候\eqref{eq:sys-env-state}中的$\ket{\psi_i}$和$\ket{B_i}$之间有某种关系，
例如，如果通过裂变的方式制备具有某种自旋的粒子束，那么我们需要的粒子和我们丢弃的粒子放在一起的态就是%
\footnote{可以看到，产生纠缠态还是需要系统和环境发生相互作用。如果系统和环境在$t=-\infty$时就没有发生相互作用，并且它们的动力学彼此不相关，那么它们的态就永远不会有纠缠。但纠缠态产生之后，就算系统和环境不再发生相互作用，纠缠还是会一直存在。}
\[
    \ket{\text{all}} = \frac{1}{\sqrt{2}} \ket{\uparrow} \ket{\uparrow} + \frac{1}{\sqrt{2}} \ket{\downarrow} \ket{\downarrow},
\]
两个粒子一旦被制备就不再有相互作用，但是显然不可能使用$\ket{\uparrow}$和$\ket{\downarrow}$的叠加写出其中任何一个粒子的态——不能够写出
\[
    \ket{\text{all}} = \left( a_1 \ket{\uparrow} + b_1 \ket{\downarrow} \right) \otimes \left( a_2 \ket{\uparrow} + b_2 \ket{\downarrow} \right)
\]
这样的表达式。
把第一个粒子看成系统而第二个粒子看成环境的一部分我们就得到了\eqref{eq:sys-env-state}形式的态。这种“总系统的态不能够写成各个部分的态的直积”情况称为\textbf{量子纠缠}。
这意味着，系统的观察结果不可能完全由诸$\ket{\psi_i}$确定，而必须考虑环境；但是通常环境是什么样的我们并不知道。
因此不能够简单地通过“求解系统-环境对的运动方程”来计算我们关心的结果，而必须通过某种手段把环境“积掉”。
具体怎么做，接下来很快会看到。

可以制备大量的这种系统-环境对，这些系统-环境对之间并没有相互作用，它们的集合称为\textbf{系综}。
系综很自然地导致一个使用古典概型的\textbf{概率}。
通过系综计算出来的概率和真的动手做变量控制得足够好的实验时的概率是一致的：动手做实验时实验结果依赖于某些环境参数$\theta$，
只要环境是足够杂乱，以至于$\theta$的分布完全随机（环境通常足够大，因此总是这样），
那么重复做实验就是采集了大量$\theta$样本，每个$\theta$确定了一个系统，从而建立了一个系综。%
\footnote{当然，系综中系统-环境对的数目总是很大的，而真实的实验做不了那么多次。这里只是原理性地说明系综这一概念的合理性。}
% TODO：以上说法和退相干等的关系
% 还有这其实有点循环论证的意味：多次实验做出来的概率和系综算出来的概率一致是因为环境提供了很好的随机数，
% 环境为什么能够提供经典意义上的随机数要严格论证还是要用到系综的概念。
% 当然如果假定了多重宇宙那就没有任何问题了——这样我们有了一个“原始系综”，因此可以严格地定义“某个事件发生的概率”：
% 它就是这个事件发生的宇宙的数目除以宇宙总数目。
另一种会自然地要求我们讨论系综的情景是，系统的初态依赖某些参数，而我们并不知道这些参数是什么，于是不得不列出所有可能的参数然后平行地让这些可能的态往前演化，看看具有不同性质的态各占多少。
很容易看出这和“多次做实验”根本就是一回事。

现在我们从这个系综当中随机取出一个系统-环境对，然后对它做一次测量，会得到什么样的结果？
算符$\hat{A}$在系统的态空间和环境的态空间的直积上显然是简并的（无论$\hat{A}$在系统的态空间上是不是简并的）。
测量态\eqref{eq:sys-env-state}的$\hat{A}$值。设$\hat{A}$的本征值$A_i$对应着系统的本征态$\ket{A_i^{(j)}}$，$j=1, 2, \ldots$。
测量结果为$A_i$的概率是
\[
    \begin{aligned}
        P(A_i) &= \sum_{j,k} \abs{\bra{A_i^{(j)}} \bra{B_k} \ket{\text{sys-env}}}^2 \\
        &= \sum_{j, k} \abs{ \bra{A_i^{(j)}} \sum_l c_l \ket{\psi_l} \braket{B_k}{B_l} }^2 \\
        &= \sum_{j, k} \abs{c_k}^2 \abs{\braket{A_i^{(j)}}{{\psi_k}}}^2 \\
        &= \sum_j \ev{ \sum_k \abs{c_k}^2 \dyad{\psi_k} }{A_i^{(j)}}
    \end{aligned}
\]
从系综中随机抽取一个系统-环境对，用$\hat{A}$做测量，得到结果为$A_i$的概率是：
\[
    \begin{aligned}
        P(A_i) &= \sum_j P(\ket{\text{sys-env}_j}) P(\text{$\ket{\text{sys-env}_j}$ gives $A_i$}) \\
        &= \sum_l P(\ket{\text{sys-env}_l}) \sum_j \ev{ \sum_k \abs{c_{l, k}}^2 \dyad{\psi_{l, k}} }{A_i^{(j)}} \\
        &= \sum_j \ev{ \sum_{l, k} P(\ket{\text{sys-env}_l}) \abs{c_{l, k}}^2 \dyad{\psi_{l, k}} }{A_i^{(j)}},
    \end{aligned}
\]
其中下标$l, k$指的是系综中第$l$个系统的第$k$个$\ket{\psi}$（见\eqref{eq:sys-env-state}）。
我们定义\textbf{密度算符}
\begin{equation}
    \hat{\rho} = \sum_{l, k} P(\ket{\text{sys-env}_l}) \abs{c_{l, k}}^2 \dyad{\psi_{l, k}},
    \label{eq:density-operator-def}
\end{equation}
就有
\begin{equation}
    P(A_i) = \sum_j \ev{\hat{\rho}}{A_i^{(j)}}.
    \label{eq:prop-of-quantity}
\end{equation}
相应的，期望值为
\[
    \expval*{\hat{A}} = \sum_{i, j} A_i \ev{\hat{\rho}}{A_i^{(j)}}.
\]
注意到
\[
    \sum_{i, j} \ev{\hat{\rho} A_i }{A_i^{(j)}} = \sum_{i, j} \ev{\hat{\rho} \hat{A} }{A_i^{(j)}} = \trace \left(\hat{\rho} \hat{A}\right),
\]
我们得到
\begin{equation}
    \expval*{\hat{A}} = \sum_{i, j} A_i \ev{\hat{\rho}}{A_i^{(j)}} = \trace \left(\hat{\rho} \hat{A}\right).
    \label{eq:expectation}
\end{equation}

在\eqref{eq:density-operator-def}中$\abs{c_{l, k}}^2$相当于是$P(\ket{\psi_{l, k}}|\ket{\text{sys-env}_l})$（归一化性质是显然的），
于是\eqref{eq:density-operator-def}写成
\begin{equation}
    \hat{\rho} = \sum_{i} P(\ket{\psi_i}) \dyad{\psi_i},
    \label{eq:density-operator}
\end{equation}
其中$P(\ket{\psi_i})$指的是从系综中随机取出一个态，经过测量发现它处于$\ket{\psi_i}$的概率。
需要注意的是，即使诸$\ket{\psi_i}$相互并不正交，\eqref{eq:density-operator}也是成立的。
如果可能的$\psi_i$只有一个，那么称此时的系综是\textbf{纯}的，或者说系统处于纯态，因为此时根本不需要引入系综的概念：直接对这个仅有的$\ket{\psi}$解运动方程就可以得到想要的一切信息。
否则，称此时的系综为\textbf{混合}的，或者说系统处于混合态。
需要注意的是即使是纯态也会引入随机性，因为测量所用的算符的本征态未必和$\ket{\psi_i}$一致。
但混合态引入了另一种随机性：我们甚至不知道系统（从系综中随便选取的某一个）具体处于什么态！
这种随机性是由于我们缺乏某些信息而产生的：我们或者不知道和我们关心的系统纠缠的态是什么样的，或者不知道我们关心的系统到底在什么态上面。

通常，对一个系综我们只关心特定的物理量取某些值的概率，以及物理量的期望，后者又可以从前者推出来。
从\eqref{eq:prop-of-quantity}和\eqref{eq:expectation}可以看出，密度算符给出了所有这些信息。
因此我们认为密度算符完整描述了系综。
除了这两项信息以外的信息则不能从密度算符中提取。例如，请注意从\eqref{eq:density-operator}中不能读取出$\ket{\psi_i}$分别都是什么，因为可以找到多组$\ket{\psi_i}$，使用不同的$P$，而得到同样的$\hat{\rho}$，也就是说不同构造的系综可以有同样的密度算符。
通常称诸$\ket{\psi_i}$为\textbf{参与态}。显然密度矩阵提供不了参与态具体是什么的信息，不过一般我们也不需要这些信息。
实际上，\eqref{eq:density-operator}本身就体现了这一点：我们并不关心混合态是因为系统和环境的纠缠还是因为别的什么引起的，因此使用统一的\eqref{eq:density-operator}处理两种情况。

一般来说，对实际的、通常规模很大的系统，我们不可能知道它的所有信息。或者我们不知道它的某些参数，或者我们不知道它是不是和环境纠缠在一起。无论哪种情况，描述系统都需要使用混合态。
因此接下来在不至于引起混淆时我们不严格区分“系统”和“系综”，因为我们根本就不知道“实际上的系统”是什么样子的，而只能讨论系综。

\subsubsection{时间演化}

下面我们分析密度矩阵的时间演化。我们将只讨论不显含时间的物理量。为了一般性，首先在相互作用绘景下分析问题。此时
\[
    \ii \hbar \dv{t} \ket{\psi^I} = \hat{H}_i^I \ket{\psi^I},
\]
由于系统和环境的演化可认为是彼此独立的，于是系统-环境的时间演化算符是系统的时间演化算符和环境的时间演化算符的直积，两者均为幺正算符，从而随着时间演化，$c_i$不会变化。
另一方面，如果两个态在某一个时刻不同，那么它们不会在某一个连续的时间区间内处处相同；
既然$P(\ket{\text{sys-env}_l})$是通过系综中相同的态的个数除以总个数算出来的，显然我们有
\[
    P_{t_1} (\ket{\text{sys-env}_l (t_1)}) = P_{t_2} (\ket{\text{sys-env}_l (t_2)}).
\]
于是以下我们略去$P$的时间下标以及其括号内的时间标记，因为这个参数对$P$而言没有意义。
因此$P(\ket{\psi_i})$恒定不变。
这样可以推导出
\begin{equation}
    \dv{\hat{\rho}^I}{t} = \frac{1}{\ii \hbar} \comm*{\hat{H}_i^I}{\hat{\rho}^I}.
\end{equation}
请注意这个方程的对易子和算符运动方程的对易子是反的。
由此，我们得出薛定谔绘景中的密度算符演化方程
\begin{equation}
    \dv{\hat{\rho}^S}{t} = \frac{1}{\ii \hbar} \comm*{\hat{H}^S}{\hat{\rho}^S},
\end{equation}
以及海森堡绘景中的密度算符演化方程
\begin{equation}
    \hat{\rho}^H = \const.
\end{equation}
请注意这些方程在$\hbar \to 0$时退化为经典统计力学中的刘维尔方程，因此称其为\textbf{量子刘维尔方程}。

系综达到平衡，也就是说，各个物理量出现的概率都不再发生任何变化的时候，意味着密度算符不变，这又等价于
\begin{equation}
    [\hat{\rho}, \hat{H}] = 0.
    \label{eq:equilibrium-case}
\end{equation}

\subsubsection{密度算符的性质}

现在来分析密度算符的性质。为方便起见以下记
\[
    P(\ket{\psi_i}) = p_i.
\]
首先，
\[
    \trace \hat{\rho} = \sum_n \mel{n}{\hat{\rho}}{n} = \sum_n \mel{n}{\sum_i p_i \dyad{\psi_i}}{n} = \sum_{n, i} p_i \braket{n}{\psi_i} \braket{\psi_i}{n},
\]
于是
\begin{equation}
    \trace \hat{\rho} = 1.
    \label{eq:trace-of-density-operator}
\end{equation}

\eqref{eq:trace-of-density-operator}无论是对纯态还是混合态都是成立的。
然而，$\hat{\rho}^2$的迹却并非如此。对纯态而言
\[
    \hat{\rho^2} = \dyad{\psi} \dyad{\psi} = \dyad{\psi} = \hat{\rho},
\]
而对混合态，
\[
    \hat{\rho}^2 = \sum_{i, j} p_i p_j \braket{\psi_i}{\psi_j} \dyad{\psi_i}{\psi_j},
\]
从而
\[
    \begin{aligned}
        \trace \hat{\rho}^2 &= \sum_n \mel{n}{\sum_{i, j} p_i p_j \braket{\psi_i}{\psi_j} \dyad{\psi_i}{\psi_j}}{n} \\
        &= \sum_{n, i, j} p_i p_j \braket{\psi_i}{\psi_j} \braket{\psi_j}{n} \braket{n}{\psi_i} \\
        &= \sum_{i, j} p_i p_j \braket{\psi_i}{\psi_j} \braket{\psi_j}{\psi_i} \\
        &=  \sum_{i, j} p_i p_j \abs{\braket{\psi_i}{\psi_j}}^2 \\
        &< \sum_{i, j} p_i p_j = 1 = \trace \hat{\rho}.
    \end{aligned}
\]
上式中我们取小于号而不是小于等于号是因为混合态中诸态不可能全部相互平行。
总之，$\hat{\rho}$幂等的充要条件是它描述了一个纯态，且
\begin{equation}
    \trace \hat{\rho}^2 \begin{cases}
        = 1, \quad & \text{for pure states}, \\
        < 1, \quad & \text{for mixed states}.
    \end{cases}
\end{equation}
也就是说密度算符能够提供“纯态还是混合态”的信息。于是可以定义一个密度算符的\textbf{纯度}为
\begin{equation}
    \varsigma = \trace \hat{\rho}^2,
\end{equation}
它越接近$1$说明系统越接近纯态。

此外很容易看出密度算符是厄米的。如果各个参与态相互正交，那么密度算符的本征值就是对应的本征态出现的概率。
当然，各个参与态完全可以不正交。

\subsubsection{复合系统}

本节将讨论，如果我们已有一个大系统的密度算符，而实际上我们只想讨论其中的一部分的行为，那么要如何写出这个部分的密度算符。
将系统分成两部分，其中一部分称为系统1，另一部分称为系统2。
设$\hat{A}$是只和系统1有关的一个算符。记描述系统2的一组基态为$\ket{\chi_i}$；$\ket{\phi_i}$是系统1的一组态，但它们未必满足正交归一化条件。
则系统的任何一个态均形如
\[
    \ket{\psi} = \sum_{i, j} c_{ij} \ket{\phi_i} \ket{\chi_j},
\]
也就是说我们使用系统2的基矢量展开整个系统的态。
从而整个系统的密度算符形如
\[
    \hat{\rho} = \sum_k p_k \sum_{i,j} \abs{c_{k,ij}}^2 \ket{\phi_i} \ket{\chi_j} \bra{\phi_i} \bra{\chi_j}
\]

现在使用$\hat{A}$对系统1做一次测量，得到$A_i$的概率为
\[
    \begin{aligned}
        P(A_i) &= \sum_{j, k} \bra*{A^{(j)}_i} \bra{\chi_k} \hat{\rho} \ket*{A^{(j)}_i} \ket{\chi_k} \\
        &= \sum_{j, k, l, m, n} p_l \abs{c_{l, mn}}^2 \braket*{A_i^{(j)}}{\phi_m} \braket*{\phi_m}{A_i^{(j)}} \braket{\chi_k}{\chi_n} \braket{\chi_n}{\chi_k} \\
        &= \sum_j \mel*{A_i^{(j)}}{\sum_m \left(\sum_{l, n} p_l \abs{c_{l, mn}}^2 \right) \dyad{\phi_m}}{A_i^{(j)}} 
    \end{aligned}.
\]
记
\[
    \hat{\rho}_1 = \sum_m \left(\sum_{l, n} p_l \abs{c_{l, mn}}^2 \right) \dyad{\phi_m}.
\]
每一项的系数看起来有些复杂，不过请注意
\[
    \abs{c_{l, mn}}^2 = P(\ket{\phi_m} \ket{\chi_n} | \ket{\psi_l}),
\]
有
\[
    \sum_{l, n} p_l \abs{c_{l, mn}}^2 = \sum_{l, n} P(\ket{\psi_l}) P(\ket{\phi_m} \ket{\chi_n} | \ket{\psi_l}) = P(\ket{\phi_m}),
\]
也就是说这个系数就是“从系综中随便取一个态做测量结果发现系统1正好就在$\ket{\phi_m}$上”的概率。
从而我们导出
\[
    \hat{\rho}_1 = \sum_m P(\ket{\phi_m}) \dyad{\phi_m}.
\]
这个表达式的形式和\eqref{eq:density-operator}一模一样。
而系统1经过测量得到$A_i$的概率则是
\[
    P(A_i) = \sum_j \mel{A^{(j)}_i}{\hat{\rho}_1}{A^{(j)}_i},
\]
相应的$\hat{A}$的期望值就是
\[
    \begin{aligned}
        \sum_i A_i P(A_i) &= \sum_{i, j} \mel{A^{(j)}_i}{\hat{\rho}_1 A_i}{A^{(j)}_i} \\
        &= \sum_{i, j} \mel{A^{(j)}_i}{\hat{\rho}_1 \hat{A}}{A^{(j)}_i} = \trace_1 \left(\hat{\rho}\hat{A}\right),
    \end{aligned}
\]
其中$\trace$的下标1表示我们是在系统1的希尔伯特空间上做迹运算。
所有这些结果都和\eqref{eq:prop-of-quantity}和\eqref{eq:expectation}完全一致。
因此我们称$\hat{\rho}_1$为\textbf{约化密度算符}。
容易验证，它可以由
\begin{equation}
    \hat{\rho}_1 = \trace_2 \hat{\rho}
\end{equation}
得到。

很容易就可以看出，以上推导和\autoref{sec:introduction-of-density-operator}中从纠缠态导出密度算符的方式完全一样。
这是当然的，因为系统1可以和系统2有纠缠，因此人为把系统1孤立出来必然导致\autoref{sec:introduction-of-density-operator}节中的操作。

% TODO:以上我们从两个系统的复合的密度矩阵导出了其中一个系统的密度矩阵（后者称为“约化密度矩阵”）。现在假设我们已有两个系统，则它们的复合的密度矩阵就是这两个系统的密度矩阵的直积。

\subsection{平衡态大系统}

接下来我们来讨论，当一个系统达到平衡态时它会具有什么性质。在系统很大（从而它不是可积的），并且和外界有小但确实有的相互作用（从而它的演化轨迹会时不时从一条偏移到另外一条上，但每条轨迹又不会有很大偏离）时，我们有\textbf{各态遍历性}：在一段时间内，系统会经过所有可能的态。%
\footnote{这些条件都是必要的：如果系统很简单，比如说，就是理想的二体问题，那么就算系统和环境有纠缠或者持续的小的相互作用也不会各态遍历——可积系统不会热化。}
所谓可能指的是和系统已知的各个参数一致，例如如果系统和外界无能量交换，那么所有可能的态就是指能量和初始能量一致的态。
系统遍历所有可能的态的时间，也就是\textbf{遍历时间}，通常远远小于我们观察的时间尺度。
显然，这就意味着在我们观察的时间尺度上均匀取样地对系统做观察，得到的结果是随机的。%
\footnote{这是又一个虽然没有实际上的随机性，但信息的缺乏意味着我们必须引入概率测度来分析问题的例子。}
相应的，系统取各个态的概率是相同的。
% TODO:为什么是相同的？



\subsection{从量子统计退化到经典统计}

\end{document}